"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/ballon-or";
exports.ids = ["pages/api/ballon-or"];
exports.modules = {

/***/ "@prisma/client":
/*!*********************************!*\
  !*** external "@prisma/client" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("@prisma/client");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fballon-or&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fballon-or.ts&middlewareConfigBase64=e30%3D!":
/*!************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fballon-or&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fballon-or.ts&middlewareConfigBase64=e30%3D! ***!
  \************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_ballon_or_ts__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages/api/ballon-or.ts */ \"(api)/./pages/api/ballon-or.ts\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_ballon_or_ts__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_ballon_or_ts__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/ballon-or\",\n        pathname: \"/api/ballon-or\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_ballon_or_ts__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRmJhbGxvbi1vciZwcmVmZXJyZWRSZWdpb249JmFic29sdXRlUGFnZVBhdGg9LiUyRnBhZ2VzJTJGYXBpJTJGYmFsbG9uLW9yLnRzJm1pZGRsZXdhcmVDb25maWdCYXNlNjQ9ZTMwJTNEISIsIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7OztBQUFzRztBQUN2QztBQUNMO0FBQzFEO0FBQ3FEO0FBQ3JEO0FBQ0EsaUVBQWUsd0VBQUssQ0FBQyxvREFBUSxZQUFZLEVBQUM7QUFDMUM7QUFDTyxlQUFlLHdFQUFLLENBQUMsb0RBQVE7QUFDcEM7QUFDTyx3QkFBd0IsZ0hBQW1CO0FBQ2xEO0FBQ0EsY0FBYyx5RUFBUztBQUN2QjtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsS0FBSztBQUNMLFlBQVk7QUFDWixDQUFDOztBQUVEIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vZm9vdHJhdGUvPzM3ZWYiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUGFnZXNBUElSb3V0ZU1vZHVsZSB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1tb2R1bGVzL3BhZ2VzLWFwaS9tb2R1bGUuY29tcGlsZWRcIjtcbmltcG9ydCB7IFJvdXRlS2luZCB9IGZyb20gXCJuZXh0L2Rpc3Qvc2VydmVyL2Z1dHVyZS9yb3V0ZS1raW5kXCI7XG5pbXBvcnQgeyBob2lzdCB9IGZyb20gXCJuZXh0L2Rpc3QvYnVpbGQvdGVtcGxhdGVzL2hlbHBlcnNcIjtcbi8vIEltcG9ydCB0aGUgdXNlcmxhbmQgY29kZS5cbmltcG9ydCAqIGFzIHVzZXJsYW5kIGZyb20gXCIuL3BhZ2VzL2FwaS9iYWxsb24tb3IudHNcIjtcbi8vIFJlLWV4cG9ydCB0aGUgaGFuZGxlciAoc2hvdWxkIGJlIHRoZSBkZWZhdWx0IGV4cG9ydCkuXG5leHBvcnQgZGVmYXVsdCBob2lzdCh1c2VybGFuZCwgXCJkZWZhdWx0XCIpO1xuLy8gUmUtZXhwb3J0IGNvbmZpZy5cbmV4cG9ydCBjb25zdCBjb25maWcgPSBob2lzdCh1c2VybGFuZCwgXCJjb25maWdcIik7XG4vLyBDcmVhdGUgYW5kIGV4cG9ydCB0aGUgcm91dGUgbW9kdWxlIHRoYXQgd2lsbCBiZSBjb25zdW1lZC5cbmV4cG9ydCBjb25zdCByb3V0ZU1vZHVsZSA9IG5ldyBQYWdlc0FQSVJvdXRlTW9kdWxlKHtcbiAgICBkZWZpbml0aW9uOiB7XG4gICAgICAgIGtpbmQ6IFJvdXRlS2luZC5QQUdFU19BUEksXG4gICAgICAgIHBhZ2U6IFwiL2FwaS9iYWxsb24tb3JcIixcbiAgICAgICAgcGF0aG5hbWU6IFwiL2FwaS9iYWxsb24tb3JcIixcbiAgICAgICAgLy8gVGhlIGZvbGxvd2luZyBhcmVuJ3QgdXNlZCBpbiBwcm9kdWN0aW9uLlxuICAgICAgICBidW5kbGVQYXRoOiBcIlwiLFxuICAgICAgICBmaWxlbmFtZTogXCJcIlxuICAgIH0sXG4gICAgdXNlcmxhbmRcbn0pO1xuXG4vLyMgc291cmNlTWFwcGluZ1VSTD1wYWdlcy1hcGkuanMubWFwIl0sIm5hbWVzIjpbXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fballon-or&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fballon-or.ts&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./lib/prisma.ts":
/*!***********************!*\
  !*** ./lib/prisma.ts ***!
  \***********************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   prisma: () => (/* binding */ prisma)\n/* harmony export */ });\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @prisma/client */ \"@prisma/client\");\n/* harmony import */ var _prisma_client__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_prisma_client__WEBPACK_IMPORTED_MODULE_0__);\n\nconst globalForPrisma = globalThis;\nconst prisma = globalForPrisma.prisma ?? new _prisma_client__WEBPACK_IMPORTED_MODULE_0__.PrismaClient();\nif (true) globalForPrisma.prisma = prisma;\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9saWIvcHJpc21hLnRzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUE2QztBQUU3QyxNQUFNQyxrQkFBa0JDO0FBSWpCLE1BQU1DLFNBQVNGLGdCQUFnQkUsTUFBTSxJQUFJLElBQUlILHdEQUFZQSxHQUFFO0FBRWxFLElBQUlJLElBQXlCLEVBQWNILGdCQUFnQkUsTUFBTSxHQUFHQSIsInNvdXJjZXMiOlsid2VicGFjazovL2Zvb3RyYXRlLy4vbGliL3ByaXNtYS50cz85ODIyIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFByaXNtYUNsaWVudCB9IGZyb20gJ0BwcmlzbWEvY2xpZW50J1xuXG5jb25zdCBnbG9iYWxGb3JQcmlzbWEgPSBnbG9iYWxUaGlzIGFzIHVua25vd24gYXMge1xuICBwcmlzbWE6IFByaXNtYUNsaWVudCB8IHVuZGVmaW5lZFxufVxuXG5leHBvcnQgY29uc3QgcHJpc21hID0gZ2xvYmFsRm9yUHJpc21hLnByaXNtYSA/PyBuZXcgUHJpc21hQ2xpZW50KClcblxuaWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WICE9PSAncHJvZHVjdGlvbicpIGdsb2JhbEZvclByaXNtYS5wcmlzbWEgPSBwcmlzbWFcbiJdLCJuYW1lcyI6WyJQcmlzbWFDbGllbnQiLCJnbG9iYWxGb3JQcmlzbWEiLCJnbG9iYWxUaGlzIiwicHJpc21hIiwicHJvY2VzcyJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./lib/prisma.ts\n");

/***/ }),

/***/ "(api)/./pages/api/ballon-or.ts":
/*!********************************!*\
  !*** ./pages/api/ballon-or.ts ***!
  \********************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _lib_prisma__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../lib/prisma */ \"(api)/./lib/prisma.ts\");\n// pages/api/ballon-or.ts - Version avec fusion intelligente des joueurs\n\nasync function handler(req, res) {\n    if (req.method !== \"GET\") {\n        return res.status(405).json({\n            error: \"Method not allowed\"\n        });\n    }\n    try {\n        const { sport = \"all\", position = \"all\", minMatches = \"3\", limit = \"50\", period = \"all-time\", excludeF1 = \"false\" // 🆕 Paramètre pour exclure F1\n         } = req.query;\n        console.log(`🏆 Calcul Ballon d'Or avec fusion joueurs - Sport: ${sport}, Min matchs: ${minMatches}`);\n        // 1. Construire les filtres\n        let sportFilter = {};\n        if (sport !== \"all\") {\n            sportFilter = {\n                sport: sport.toString().toUpperCase()\n            };\n        } else if (excludeF1 === \"true\") {\n            // 🚫 Exclure F1 du Ballon d'Or classique\n            sportFilter = {\n                sport: {\n                    not: \"F1\"\n                }\n            };\n        }\n        let positionFilter = {};\n        if (position !== \"all\") {\n            positionFilter = {\n                position: position.toString()\n            };\n        }\n        // 2. Filtre par période\n        let dateFilter = {};\n        const now = new Date();\n        switch(period){\n            case \"this-year\":\n                const yearAgo = new Date();\n                yearAgo.setFullYear(now.getFullYear() - 1);\n                dateFilter = {\n                    createdAt: {\n                        gte: yearAgo\n                    }\n                };\n                break;\n            case \"this-season\":\n                const seasonStart = new Date();\n                seasonStart.setMonth(8) // Septembre\n                ;\n                if (now.getMonth() < 8) {\n                    seasonStart.setFullYear(now.getFullYear() - 1);\n                }\n                dateFilter = {\n                    createdAt: {\n                        gte: seasonStart\n                    }\n                };\n                break;\n            case \"last-6-months\":\n                const sixMonthsAgo = new Date();\n                sixMonthsAgo.setMonth(now.getMonth() - 6);\n                dateFilter = {\n                    createdAt: {\n                        gte: sixMonthsAgo\n                    }\n                };\n                break;\n            default:\n                break;\n        }\n        // 3. Récupérer TOUS les joueurs avec leurs notes\n        const playersWithRatings = await _lib_prisma__WEBPACK_IMPORTED_MODULE_0__.prisma.player.findMany({\n            where: {\n                ...sportFilter,\n                ratings: {\n                    some: {\n                        ...dateFilter\n                    }\n                }\n            },\n            include: {\n                ratings: {\n                    where: dateFilter,\n                    include: {\n                        match: {\n                            select: {\n                                id: true,\n                                homeTeam: true,\n                                awayTeam: true,\n                                date: true,\n                                competition: true,\n                                sport: true\n                            }\n                        },\n                        user: {\n                            select: {\n                                id: true,\n                                name: true\n                            }\n                        }\n                    },\n                    orderBy: {\n                        createdAt: \"desc\"\n                    }\n                }\n            }\n        });\n        console.log(`👥 ${playersWithRatings.length} joueurs bruts récupérés`);\n        // 4. 🧠 FUSION INTELLIGENTE DES JOUEURS\n        const fusedPlayers = new Map();\n        for (const player of playersWithRatings){\n            if (player.ratings.length === 0) continue;\n            // Normaliser le nom pour la fusion\n            const normalizedName = normalizePlayerName(player.name);\n            // Si le joueur existe déjà (même nom normalisé), fusionner\n            if (fusedPlayers.has(normalizedName)) {\n                const existingPlayer = fusedPlayers.get(normalizedName);\n                // Fusionner les données\n                existingPlayer.ratings.push(...player.ratings);\n                existingPlayer.teams.add(player.team);\n                if (player.position) {\n                    existingPlayer.positions.add(player.position);\n                }\n                console.log(`🔗 Fusion: ${player.name} (${player.team}) avec ${existingPlayer.name}`);\n            } else {\n                // Nouveau joueur\n                fusedPlayers.set(normalizedName, {\n                    originalId: player.id,\n                    name: player.name,\n                    normalizedName,\n                    sport: player.sport,\n                    teams: new Set([\n                        player.team\n                    ]),\n                    positions: new Set(player.position ? [\n                        player.position\n                    ] : []),\n                    ratings: [\n                        ...player.ratings\n                    ]\n                });\n            }\n        }\n        console.log(`🔗 Après fusion: ${fusedPlayers.size} joueurs uniques`);\n        // 5. Calculer les statistiques pour chaque joueur fusionné\n        const ballonOrCandidates = [];\n        for (const [normalizedName, fusedPlayer] of fusedPlayers.entries()){\n            const ratings = fusedPlayer.ratings;\n            if (ratings.length < parseInt(minMatches.toString())) {\n                continue;\n            }\n            // Filtre position après fusion\n            if (position !== \"all\" && !fusedPlayer.positions.has(position)) {\n                continue;\n            }\n            // Calculer la moyenne globale\n            const avgRating = ratings.reduce((sum, r)=>sum + r.rating, 0) / ratings.length;\n            // Trouver le meilleur match\n            const bestRating = ratings.reduce((best, current)=>current.rating > best.rating ? current : best);\n            // Récupérer les matchs uniques avec moyenne par match\n            const uniqueMatches = new Map();\n            ratings.forEach((rating)=>{\n                const matchId = rating.match.id;\n                if (!uniqueMatches.has(matchId)) {\n                    uniqueMatches.set(matchId, {\n                        match: rating.match,\n                        ratings: []\n                    });\n                }\n                uniqueMatches.get(matchId).ratings.push(rating);\n            });\n            const totalMatches = uniqueMatches.size;\n            // Calculer les 5 matchs les plus récents\n            const recentMatches = Array.from(uniqueMatches.values()).sort((a, b)=>new Date(b.match.date).getTime() - new Date(a.match.date).getTime()).slice(0, 5).map((matchData)=>{\n                const matchAvgRating = matchData.ratings.reduce((sum, r)=>sum + r.rating, 0) / matchData.ratings.length;\n                const bestComment = matchData.ratings.find((r)=>r.comment)?.comment;\n                // Déterminer l'équipe du joueur pour ce match\n                const playerTeam = getPlayerTeamForMatch(matchData.match, Array.from(fusedPlayer.teams));\n                return {\n                    matchId: matchData.match.id,\n                    rating: Number(matchAvgRating.toFixed(1)),\n                    comment: bestComment,\n                    homeTeam: matchData.match.homeTeam,\n                    awayTeam: matchData.match.awayTeam,\n                    date: matchData.match.date,\n                    competition: matchData.match.competition,\n                    team: playerTeam\n                };\n            });\n            // Calculer l'historique mensuel\n            const ratingHistory = calculateMonthlyHistory(ratings);\n            // Calculer la répartition par équipe\n            const teamBreakdown = calculateTeamBreakdown(ratings, Array.from(fusedPlayer.teams));\n            // Déterminer l'équipe du meilleur match\n            const bestMatchTeam = getPlayerTeamForMatch(bestRating.match, Array.from(fusedPlayer.teams));\n            ballonOrCandidates.push({\n                id: `fused_${normalizedName}`,\n                name: fusedPlayer.name,\n                normalizedName,\n                positions: Array.from(fusedPlayer.positions),\n                teams: Array.from(fusedPlayer.teams),\n                sport: fusedPlayer.sport,\n                avgRating: Number(avgRating.toFixed(2)),\n                totalRatings: ratings.length,\n                totalMatches,\n                bestMatch: {\n                    id: bestRating.match.id,\n                    rating: bestRating.rating,\n                    homeTeam: bestRating.match.homeTeam,\n                    awayTeam: bestRating.match.awayTeam,\n                    date: bestRating.match.date,\n                    competition: bestRating.match.competition,\n                    team: bestMatchTeam\n                },\n                recentMatches,\n                ratingHistory,\n                teamBreakdown\n            });\n        }\n        // 6. Trier par moyenne des notes\n        ballonOrCandidates.sort((a, b)=>{\n            if (Math.abs(a.avgRating - b.avgRating) < 0.01) {\n                return b.totalMatches - a.totalMatches;\n            }\n            return b.avgRating - a.avgRating;\n        });\n        // 7. Limiter les résultats\n        const topPlayers = ballonOrCandidates.slice(0, parseInt(limit.toString()));\n        // 8. Statistiques globales\n        const globalStats = {\n            totalPlayers: ballonOrCandidates.length,\n            totalRatings: ballonOrCandidates.reduce((sum, p)=>sum + p.totalRatings, 0),\n            totalMatches: ballonOrCandidates.reduce((sum, p)=>sum + p.totalMatches, 0),\n            avgRatingGlobal: ballonOrCandidates.length > 0 ? ballonOrCandidates.reduce((sum, p)=>sum + p.avgRating, 0) / ballonOrCandidates.length : 0,\n            topRating: topPlayers[0]?.avgRating || 0,\n            sportBreakdown: calculateSportBreakdown(ballonOrCandidates),\n            fusionStats: {\n                originalPlayers: playersWithRatings.length,\n                fusedPlayers: ballonOrCandidates.length,\n                fusionReduction: playersWithRatings.length - ballonOrCandidates.length\n            }\n        };\n        console.log(`🏆 Ballon d'Or avec fusion calculé:`);\n        console.log(`   - ${playersWithRatings.length} joueurs originaux`);\n        console.log(`   - ${ballonOrCandidates.length} joueurs après fusion`);\n        console.log(`   - Leader: ${topPlayers[0]?.name} (${topPlayers[0]?.avgRating}/10)`);\n        console.log(`   - Équipes: ${topPlayers[0]?.teams.join(\", \")}`);\n        res.status(200).json({\n            success: true,\n            ballonOr: topPlayers,\n            stats: globalStats,\n            filters: {\n                sport,\n                position,\n                period,\n                minMatches: parseInt(minMatches.toString())\n            }\n        });\n    } catch (error) {\n        console.error(\"❌ Erreur Ballon d'Or avec fusion:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"Erreur serveur\",\n            details: error instanceof Error ? error.message : \"Erreur inconnue\"\n        });\n    }\n}\n// 🧠 Fonction de normalisation intelligente des noms\nfunction normalizePlayerName(name) {\n    let normalized = name.toLowerCase().trim()// Supprimer les accents\n    .normalize(\"NFD\").replace(/[\\u0300-\\u036f]/g, \"\")// Supprimer les caractères spéciaux sauf espaces et tirets\n    .replace(/[^a-z\\s-]/g, \"\")// Supprimer les doubles espaces\n    .replace(/\\s+/g, \" \")// Supprimer les espaces en début/fin\n    .trim();\n    // 🔍 Normalisation spéciale pour les noms avec initiales\n    // \"K. Mbappé\" -> \"kylian mbappe\"  \n    // \"R. Cherki\" -> \"rayan cherki\"\n    const initialMappings = {\n        \"k mbappe\": \"kylian mbappe\",\n        \"k. mbappe\": \"kylian mbappe\",\n        \"kylian mbappe\": \"kylian mbappe\",\n        \"r cherki\": \"rayan cherki\",\n        \"r. cherki\": \"rayan cherki\",\n        \"rayan cherki\": \"rayan cherki\",\n        \"a griezmann\": \"antoine griezmann\",\n        \"a. griezmann\": \"antoine griezmann\",\n        \"antoine griezmann\": \"antoine griezmann\",\n        \"l james\": \"lebron james\",\n        \"l. james\": \"lebron james\",\n        \"lebron james\": \"lebron james\"\n    };\n    // Vérifier si on a une correspondance dans les mappings\n    if (initialMappings[normalized]) {\n        normalized = initialMappings[normalized];\n    }\n    console.log(`🔍 Normalisation: \"${name}\" -> \"${normalized}\"`);\n    return normalized;\n}\n// Fonction pour déterminer l'équipe du joueur dans un match\nfunction getPlayerTeamForMatch(match, playerTeams) {\n    // Essayer de faire correspondre avec les équipes du match\n    const homeTeam = match.homeTeam.toLowerCase();\n    const awayTeam = match.awayTeam.toLowerCase();\n    for (const team of playerTeams){\n        const teamLower = team.toLowerCase();\n        // Correspondance exacte ou partielle\n        if (homeTeam.includes(teamLower) || teamLower.includes(homeTeam.split(\" \")[0])) {\n            return match.homeTeam;\n        }\n        if (awayTeam.includes(teamLower) || teamLower.includes(awayTeam.split(\" \")[0])) {\n            return match.awayTeam;\n        }\n        // Pour les équipes nationales\n        if (team.includes(\"France\") && (homeTeam.includes(\"france\") || awayTeam.includes(\"france\"))) {\n            return homeTeam.includes(\"france\") ? match.homeTeam : match.awayTeam;\n        }\n    }\n    // Si aucune correspondance, retourner la première équipe connue\n    return playerTeams[0] || \"\\xc9quipe inconnue\";\n}\n// Calculer la répartition par équipe\nfunction calculateTeamBreakdown(ratings, teams) {\n    const teamStats = new Map();\n    // Initialiser les stats pour chaque équipe\n    teams.forEach((team)=>{\n        teamStats.set(team, {\n            team,\n            ratings: [],\n            matches: new Set()\n        });\n    });\n    // Répartir les ratings par équipe (basé sur le match)\n    ratings.forEach((rating)=>{\n        const playerTeam = getPlayerTeamForMatch(rating.match, teams);\n        const normalizedTeam = teams.find((t)=>t.toLowerCase().includes(playerTeam.toLowerCase()) || playerTeam.toLowerCase().includes(t.toLowerCase())) || teams[0];\n        if (teamStats.has(normalizedTeam)) {\n            teamStats.get(normalizedTeam).ratings.push(rating.rating);\n            teamStats.get(normalizedTeam).matches.add(rating.match.id);\n        }\n    });\n    // Calculer les moyennes\n    return Array.from(teamStats.values()).filter((stats)=>stats.ratings.length > 0).map((stats)=>({\n            team: stats.team,\n            avgRating: Number((stats.ratings.reduce((sum, r)=>sum + r, 0) / stats.ratings.length).toFixed(2)),\n            matchCount: stats.matches.size,\n            ratingCount: stats.ratings.length\n        })).sort((a, b)=>b.avgRating - a.avgRating);\n}\n// Fonctions utilitaires existantes (inchangées)\nfunction calculateMonthlyHistory(ratings) {\n    const monthlyData = new Map();\n    ratings.forEach((rating)=>{\n        const date = new Date(rating.createdAt);\n        const monthKey = `${date.getFullYear()}-${(date.getMonth() + 1).toString().padStart(2, \"0\")}`;\n        if (!monthlyData.has(monthKey)) {\n            monthlyData.set(monthKey, {\n                ratings: [],\n                matches: new Set()\n            });\n        }\n        monthlyData.get(monthKey).ratings.push(rating.rating);\n        monthlyData.get(monthKey).matches.add(rating.match.id);\n    });\n    return Array.from(monthlyData.entries()).map(([month, data])=>({\n            month,\n            avgRating: Number((data.ratings.reduce((sum, r)=>sum + r, 0) / data.ratings.length).toFixed(2)),\n            matchCount: data.matches.size\n        })).sort((a, b)=>a.month.localeCompare(b.month)).slice(-12);\n}\nfunction calculateSportBreakdown(players) {\n    const breakdown = new Map();\n    players.forEach((player)=>{\n        if (!breakdown.has(player.sport)) {\n            breakdown.set(player.sport, {\n                count: 0,\n                totalRatings: 0\n            });\n        }\n        const data = breakdown.get(player.sport);\n        data.count++;\n        data.totalRatings += player.totalRatings;\n    });\n    return Array.from(breakdown.entries()).map(([sport, data])=>({\n            sport,\n            playerCount: data.count,\n            avgRating: players.filter((p)=>p.sport === sport).reduce((sum, p)=>sum + p.avgRating, 0) / data.count,\n            totalRatings: data.totalRatings\n        }));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvYmFsbG9uLW9yLnRzIiwibWFwcGluZ3MiOiI7Ozs7O0FBQUEsd0VBQXdFO0FBRS9CO0FBNEMxQixlQUFlQyxRQUFRQyxHQUFtQixFQUFFQyxHQUFvQjtJQUM3RSxJQUFJRCxJQUFJRSxNQUFNLEtBQUssT0FBTztRQUN4QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBcUI7SUFDNUQ7SUFFQSxJQUFJO1FBQ0YsTUFBTSxFQUNKQyxRQUFRLEtBQUssRUFDYkMsV0FBVyxLQUFLLEVBQ2hCQyxhQUFhLEdBQUcsRUFDaEJDLFFBQVEsSUFBSSxFQUNaQyxTQUFTLFVBQVUsRUFDbkJDLFlBQVksUUFBUSwrQkFBK0I7UUFBaEMsRUFDcEIsR0FBR1gsSUFBSVksS0FBSztRQUViQyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxtREFBbUQsRUFBRVIsTUFBTSxjQUFjLEVBQUVFLFdBQVcsQ0FBQztRQUVwRyw0QkFBNEI7UUFDNUIsSUFBSU8sY0FBYyxDQUFDO1FBQ25CLElBQUlULFVBQVUsT0FBTztZQUNuQlMsY0FBYztnQkFBRVQsT0FBT0EsTUFBTVUsUUFBUSxHQUFHQyxXQUFXO1lBQUc7UUFDeEQsT0FBTyxJQUFJTixjQUFjLFFBQVE7WUFDL0IseUNBQXlDO1lBQ3pDSSxjQUFjO2dCQUNaVCxPQUFPO29CQUNMWSxLQUFLO2dCQUNQO1lBQ0Y7UUFDRjtRQUVBLElBQUlDLGlCQUFpQixDQUFDO1FBQ3RCLElBQUlaLGFBQWEsT0FBTztZQUN0QlksaUJBQWlCO2dCQUFFWixVQUFVQSxTQUFTUyxRQUFRO1lBQUc7UUFDbkQ7UUFFQSx3QkFBd0I7UUFDeEIsSUFBSUksYUFBYSxDQUFDO1FBQ2xCLE1BQU1DLE1BQU0sSUFBSUM7UUFFaEIsT0FBUVo7WUFDTixLQUFLO2dCQUNILE1BQU1hLFVBQVUsSUFBSUQ7Z0JBQ3BCQyxRQUFRQyxXQUFXLENBQUNILElBQUlJLFdBQVcsS0FBSztnQkFDeENMLGFBQWE7b0JBQUVNLFdBQVc7d0JBQUVDLEtBQUtKO29CQUFRO2dCQUFFO2dCQUMzQztZQUNGLEtBQUs7Z0JBQ0gsTUFBTUssY0FBYyxJQUFJTjtnQkFDeEJNLFlBQVlDLFFBQVEsQ0FBQyxHQUFHLFlBQVk7O2dCQUNwQyxJQUFJUixJQUFJUyxRQUFRLEtBQUssR0FBRztvQkFDdEJGLFlBQVlKLFdBQVcsQ0FBQ0gsSUFBSUksV0FBVyxLQUFLO2dCQUM5QztnQkFDQUwsYUFBYTtvQkFBRU0sV0FBVzt3QkFBRUMsS0FBS0M7b0JBQVk7Z0JBQUU7Z0JBQy9DO1lBQ0YsS0FBSztnQkFDSCxNQUFNRyxlQUFlLElBQUlUO2dCQUN6QlMsYUFBYUYsUUFBUSxDQUFDUixJQUFJUyxRQUFRLEtBQUs7Z0JBQ3ZDVixhQUFhO29CQUFFTSxXQUFXO3dCQUFFQyxLQUFLSTtvQkFBYTtnQkFBRTtnQkFDaEQ7WUFDRjtnQkFDRTtRQUNKO1FBRUEsaURBQWlEO1FBQ2pELE1BQU1DLHFCQUFxQixNQUFNbEMsK0NBQU1BLENBQUNtQyxNQUFNLENBQUNDLFFBQVEsQ0FBQztZQUN0REMsT0FBTztnQkFDTCxHQUFHcEIsV0FBVztnQkFDZHFCLFNBQVM7b0JBQ1BDLE1BQU07d0JBQ0osR0FBR2pCLFVBQVU7b0JBQ2Y7Z0JBQ0Y7WUFDRjtZQUNBa0IsU0FBUztnQkFDUEYsU0FBUztvQkFDUEQsT0FBT2Y7b0JBQ1BrQixTQUFTO3dCQUNQQyxPQUFPOzRCQUNMQyxRQUFRO2dDQUNOQyxJQUFJO2dDQUNKQyxVQUFVO2dDQUNWQyxVQUFVO2dDQUNWQyxNQUFNO2dDQUNOQyxhQUFhO2dDQUNidkMsT0FBTzs0QkFDVDt3QkFDRjt3QkFDQXdDLE1BQU07NEJBQ0pOLFFBQVE7Z0NBQ05DLElBQUk7Z0NBQ0pNLE1BQU07NEJBQ1I7d0JBQ0Y7b0JBQ0Y7b0JBQ0FDLFNBQVM7d0JBQUV0QixXQUFXO29CQUFPO2dCQUMvQjtZQUNGO1FBQ0Y7UUFFQWIsUUFBUUMsR0FBRyxDQUFDLENBQUMsR0FBRyxFQUFFa0IsbUJBQW1CaUIsTUFBTSxDQUFDLHdCQUF3QixDQUFDO1FBRXJFLHdDQUF3QztRQUN4QyxNQUFNQyxlQUFlLElBQUlDO1FBRXpCLEtBQUssTUFBTWxCLFVBQVVELG1CQUFvQjtZQUN2QyxJQUFJQyxPQUFPRyxPQUFPLENBQUNhLE1BQU0sS0FBSyxHQUFHO1lBRWpDLG1DQUFtQztZQUNuQyxNQUFNRyxpQkFBaUJDLG9CQUFvQnBCLE9BQU9jLElBQUk7WUFFdEQsMkRBQTJEO1lBQzNELElBQUlHLGFBQWFJLEdBQUcsQ0FBQ0YsaUJBQWlCO2dCQUNwQyxNQUFNRyxpQkFBaUJMLGFBQWFNLEdBQUcsQ0FBQ0o7Z0JBRXhDLHdCQUF3QjtnQkFDeEJHLGVBQWVuQixPQUFPLENBQUNxQixJQUFJLElBQUl4QixPQUFPRyxPQUFPO2dCQUM3Q21CLGVBQWVHLEtBQUssQ0FBQ0MsR0FBRyxDQUFDMUIsT0FBTzJCLElBQUk7Z0JBQ3BDLElBQUkzQixPQUFPMUIsUUFBUSxFQUFFO29CQUNuQmdELGVBQWVNLFNBQVMsQ0FBQ0YsR0FBRyxDQUFDMUIsT0FBTzFCLFFBQVE7Z0JBQzlDO2dCQUVBTSxRQUFRQyxHQUFHLENBQUMsQ0FBQyxXQUFXLEVBQUVtQixPQUFPYyxJQUFJLENBQUMsRUFBRSxFQUFFZCxPQUFPMkIsSUFBSSxDQUFDLE9BQU8sRUFBRUwsZUFBZVIsSUFBSSxDQUFDLENBQUM7WUFDdEYsT0FBTztnQkFDTCxpQkFBaUI7Z0JBQ2pCRyxhQUFhWSxHQUFHLENBQUNWLGdCQUFnQjtvQkFDL0JXLFlBQVk5QixPQUFPUSxFQUFFO29CQUNyQk0sTUFBTWQsT0FBT2MsSUFBSTtvQkFDakJLO29CQUNBOUMsT0FBTzJCLE9BQU8zQixLQUFLO29CQUNuQm9ELE9BQU8sSUFBSU0sSUFBSTt3QkFBQy9CLE9BQU8yQixJQUFJO3FCQUFDO29CQUM1QkMsV0FBVyxJQUFJRyxJQUFJL0IsT0FBTzFCLFFBQVEsR0FBRzt3QkFBQzBCLE9BQU8xQixRQUFRO3FCQUFDLEdBQUcsRUFBRTtvQkFDM0Q2QixTQUFTOzJCQUFJSCxPQUFPRyxPQUFPO3FCQUFDO2dCQUM5QjtZQUNGO1FBQ0Y7UUFFQXZCLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGlCQUFpQixFQUFFb0MsYUFBYWUsSUFBSSxDQUFDLGdCQUFnQixDQUFDO1FBRW5FLDJEQUEyRDtRQUMzRCxNQUFNQyxxQkFBdUMsRUFBRTtRQUUvQyxLQUFLLE1BQU0sQ0FBQ2QsZ0JBQWdCZSxZQUFZLElBQUlqQixhQUFha0IsT0FBTyxHQUFJO1lBQ2xFLE1BQU1oQyxVQUFVK0IsWUFBWS9CLE9BQU87WUFFbkMsSUFBSUEsUUFBUWEsTUFBTSxHQUFHb0IsU0FBUzdELFdBQVdRLFFBQVEsS0FBSztnQkFDcEQ7WUFDRjtZQUVBLCtCQUErQjtZQUMvQixJQUFJVCxhQUFhLFNBQVMsQ0FBQzRELFlBQVlOLFNBQVMsQ0FBQ1AsR0FBRyxDQUFDL0MsV0FBVztnQkFDOUQ7WUFDRjtZQUVBLDhCQUE4QjtZQUM5QixNQUFNK0QsWUFBWWxDLFFBQVFtQyxNQUFNLENBQUMsQ0FBQ0MsS0FBYUMsSUFBV0QsTUFBTUMsRUFBRUMsTUFBTSxFQUFFLEtBQUt0QyxRQUFRYSxNQUFNO1lBRTdGLDRCQUE0QjtZQUM1QixNQUFNMEIsYUFBYXZDLFFBQVFtQyxNQUFNLENBQUMsQ0FBQ0ssTUFBV0MsVUFDNUNBLFFBQVFILE1BQU0sR0FBR0UsS0FBS0YsTUFBTSxHQUFHRyxVQUFVRDtZQUczQyxzREFBc0Q7WUFDdEQsTUFBTUUsZ0JBQWdCLElBQUkzQjtZQUMxQmYsUUFBUTJDLE9BQU8sQ0FBQyxDQUFDTDtnQkFDZixNQUFNTSxVQUFVTixPQUFPbkMsS0FBSyxDQUFDRSxFQUFFO2dCQUMvQixJQUFJLENBQUNxQyxjQUFjeEIsR0FBRyxDQUFDMEIsVUFBVTtvQkFDL0JGLGNBQWNoQixHQUFHLENBQUNrQixTQUFTO3dCQUN6QnpDLE9BQU9tQyxPQUFPbkMsS0FBSzt3QkFDbkJILFNBQVMsRUFBRTtvQkFDYjtnQkFDRjtnQkFDQTBDLGNBQWN0QixHQUFHLENBQUN3QixTQUFTNUMsT0FBTyxDQUFDcUIsSUFBSSxDQUFDaUI7WUFDMUM7WUFFQSxNQUFNTyxlQUFlSCxjQUFjYixJQUFJO1lBRXZDLHlDQUF5QztZQUN6QyxNQUFNaUIsZ0JBQWdCQyxNQUFNQyxJQUFJLENBQUNOLGNBQWNPLE1BQU0sSUFDbERDLElBQUksQ0FBQyxDQUFDQyxHQUFRQyxJQUFXLElBQUlsRSxLQUFLa0UsRUFBRWpELEtBQUssQ0FBQ0ssSUFBSSxFQUFFNkMsT0FBTyxLQUFLLElBQUluRSxLQUFLaUUsRUFBRWhELEtBQUssQ0FBQ0ssSUFBSSxFQUFFNkMsT0FBTyxJQUMxRkMsS0FBSyxDQUFDLEdBQUcsR0FDVEMsR0FBRyxDQUFDLENBQUNDO2dCQUNKLE1BQU1DLGlCQUFpQkQsVUFBVXhELE9BQU8sQ0FBQ21DLE1BQU0sQ0FBQyxDQUFDQyxLQUFhQyxJQUFXRCxNQUFNQyxFQUFFQyxNQUFNLEVBQUUsS0FBS2tCLFVBQVV4RCxPQUFPLENBQUNhLE1BQU07Z0JBQ3RILE1BQU02QyxjQUFjRixVQUFVeEQsT0FBTyxDQUFDMkQsSUFBSSxDQUFDLENBQUN0QixJQUFXQSxFQUFFdUIsT0FBTyxHQUFHQTtnQkFFbkUsOENBQThDO2dCQUM5QyxNQUFNQyxhQUFhQyxzQkFBc0JOLFVBQVVyRCxLQUFLLEVBQUU0QyxNQUFNQyxJQUFJLENBQUNqQixZQUFZVCxLQUFLO2dCQUV0RixPQUFPO29CQUNMc0IsU0FBU1ksVUFBVXJELEtBQUssQ0FBQ0UsRUFBRTtvQkFDM0JpQyxRQUFReUIsT0FBT04sZUFBZU8sT0FBTyxDQUFDO29CQUN0Q0osU0FBU0Y7b0JBQ1RwRCxVQUFVa0QsVUFBVXJELEtBQUssQ0FBQ0csUUFBUTtvQkFDbENDLFVBQVVpRCxVQUFVckQsS0FBSyxDQUFDSSxRQUFRO29CQUNsQ0MsTUFBTWdELFVBQVVyRCxLQUFLLENBQUNLLElBQUk7b0JBQzFCQyxhQUFhK0MsVUFBVXJELEtBQUssQ0FBQ00sV0FBVztvQkFDeENlLE1BQU1xQztnQkFDUjtZQUNGO1lBRUYsZ0NBQWdDO1lBQ2hDLE1BQU1JLGdCQUFnQkMsd0JBQXdCbEU7WUFFOUMscUNBQXFDO1lBQ3JDLE1BQU1tRSxnQkFBZ0JDLHVCQUF1QnBFLFNBQVMrQyxNQUFNQyxJQUFJLENBQUNqQixZQUFZVCxLQUFLO1lBRWxGLHdDQUF3QztZQUN4QyxNQUFNK0MsZ0JBQWdCUCxzQkFBc0J2QixXQUFXcEMsS0FBSyxFQUFFNEMsTUFBTUMsSUFBSSxDQUFDakIsWUFBWVQsS0FBSztZQUUxRlEsbUJBQW1CVCxJQUFJLENBQUM7Z0JBQ3RCaEIsSUFBSSxDQUFDLE1BQU0sRUFBRVcsZUFBZSxDQUFDO2dCQUM3QkwsTUFBTW9CLFlBQVlwQixJQUFJO2dCQUN0Qks7Z0JBQ0FTLFdBQVdzQixNQUFNQyxJQUFJLENBQUNqQixZQUFZTixTQUFTO2dCQUMzQ0gsT0FBT3lCLE1BQU1DLElBQUksQ0FBQ2pCLFlBQVlULEtBQUs7Z0JBQ25DcEQsT0FBTzZELFlBQVk3RCxLQUFLO2dCQUN4QmdFLFdBQVc2QixPQUFPN0IsVUFBVThCLE9BQU8sQ0FBQztnQkFDcENNLGNBQWN0RSxRQUFRYSxNQUFNO2dCQUM1QmdDO2dCQUNBMEIsV0FBVztvQkFDVGxFLElBQUlrQyxXQUFXcEMsS0FBSyxDQUFDRSxFQUFFO29CQUN2QmlDLFFBQVFDLFdBQVdELE1BQU07b0JBQ3pCaEMsVUFBVWlDLFdBQVdwQyxLQUFLLENBQUNHLFFBQVE7b0JBQ25DQyxVQUFVZ0MsV0FBV3BDLEtBQUssQ0FBQ0ksUUFBUTtvQkFDbkNDLE1BQU0rQixXQUFXcEMsS0FBSyxDQUFDSyxJQUFJO29CQUMzQkMsYUFBYThCLFdBQVdwQyxLQUFLLENBQUNNLFdBQVc7b0JBQ3pDZSxNQUFNNkM7Z0JBQ1I7Z0JBQ0F2QjtnQkFDQW1CO2dCQUNBRTtZQUNGO1FBQ0Y7UUFFQSxpQ0FBaUM7UUFDakNyQyxtQkFBbUJvQixJQUFJLENBQUMsQ0FBQ0MsR0FBR0M7WUFDMUIsSUFBSW9CLEtBQUtDLEdBQUcsQ0FBQ3RCLEVBQUVqQixTQUFTLEdBQUdrQixFQUFFbEIsU0FBUyxJQUFJLE1BQU07Z0JBQzlDLE9BQU9rQixFQUFFUCxZQUFZLEdBQUdNLEVBQUVOLFlBQVk7WUFDeEM7WUFDQSxPQUFPTyxFQUFFbEIsU0FBUyxHQUFHaUIsRUFBRWpCLFNBQVM7UUFDbEM7UUFFQSwyQkFBMkI7UUFDM0IsTUFBTXdDLGFBQWE1QyxtQkFBbUJ3QixLQUFLLENBQUMsR0FBR3JCLFNBQVM1RCxNQUFNTyxRQUFRO1FBRXRFLDJCQUEyQjtRQUMzQixNQUFNK0YsY0FBYztZQUNsQkMsY0FBYzlDLG1CQUFtQmpCLE1BQU07WUFDdkN5RCxjQUFjeEMsbUJBQW1CSyxNQUFNLENBQUMsQ0FBQ0MsS0FBS3lDLElBQU16QyxNQUFNeUMsRUFBRVAsWUFBWSxFQUFFO1lBQzFFekIsY0FBY2YsbUJBQW1CSyxNQUFNLENBQUMsQ0FBQ0MsS0FBS3lDLElBQU16QyxNQUFNeUMsRUFBRWhDLFlBQVksRUFBRTtZQUMxRWlDLGlCQUFpQmhELG1CQUFtQmpCLE1BQU0sR0FBRyxJQUN6Q2lCLG1CQUFtQkssTUFBTSxDQUFDLENBQUNDLEtBQUt5QyxJQUFNekMsTUFBTXlDLEVBQUUzQyxTQUFTLEVBQUUsS0FBS0osbUJBQW1CakIsTUFBTSxHQUN2RjtZQUNKa0UsV0FBV0wsVUFBVSxDQUFDLEVBQUUsRUFBRXhDLGFBQWE7WUFDdkM4QyxnQkFBZ0JDLHdCQUF3Qm5EO1lBQ3hDb0QsYUFBYTtnQkFDWEMsaUJBQWlCdkYsbUJBQW1CaUIsTUFBTTtnQkFDMUNDLGNBQWNnQixtQkFBbUJqQixNQUFNO2dCQUN2Q3VFLGlCQUFpQnhGLG1CQUFtQmlCLE1BQU0sR0FBR2lCLG1CQUFtQmpCLE1BQU07WUFDeEU7UUFDRjtRQUVBcEMsUUFBUUMsR0FBRyxDQUFDLENBQUMsbUNBQW1DLENBQUM7UUFDakRELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRWtCLG1CQUFtQmlCLE1BQU0sQ0FBQyxrQkFBa0IsQ0FBQztRQUNqRXBDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLEtBQUssRUFBRW9ELG1CQUFtQmpCLE1BQU0sQ0FBQyxxQkFBcUIsQ0FBQztRQUNwRXBDLFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGFBQWEsRUFBRWdHLFVBQVUsQ0FBQyxFQUFFLEVBQUUvRCxLQUFLLEVBQUUsRUFBRStELFVBQVUsQ0FBQyxFQUFFLEVBQUV4QyxVQUFVLElBQUksQ0FBQztRQUNsRnpELFFBQVFDLEdBQUcsQ0FBQyxDQUFDLGNBQWMsRUFBRWdHLFVBQVUsQ0FBQyxFQUFFLEVBQUVwRCxNQUFNK0QsS0FBSyxNQUFNLENBQUM7UUFFOUR4SCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQ25Cc0gsU0FBUztZQUNUQyxVQUFVYjtZQUNWYyxPQUFPYjtZQUNQYyxTQUFTO2dCQUNQdkg7Z0JBQ0FDO2dCQUNBRztnQkFDQUYsWUFBWTZELFNBQVM3RCxXQUFXUSxRQUFRO1lBQzFDO1FBQ0Y7SUFFRixFQUFFLE9BQU9YLE9BQU87UUFDZFEsUUFBUVIsS0FBSyxDQUFDLHFDQUFzQ0E7UUFDcERKLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFDbkJzSCxTQUFTO1lBQ1RySCxPQUFPO1lBQ1B5SCxTQUFTekgsaUJBQWlCMEgsUUFBUTFILE1BQU0ySCxPQUFPLEdBQUc7UUFDcEQ7SUFDRjtBQUNGO0FBRUEscURBQXFEO0FBQ3JELFNBQVMzRSxvQkFBb0JOLElBQVk7SUFDdkMsSUFBSWtGLGFBQWFsRixLQUNkbUYsV0FBVyxHQUNYQyxJQUFJLEVBQ0wsd0JBQXdCO0tBQ3ZCQyxTQUFTLENBQUMsT0FBT0MsT0FBTyxDQUFDLG9CQUFvQixHQUM5QywyREFBMkQ7S0FDMURBLE9BQU8sQ0FBQyxjQUFjLEdBQ3ZCLGdDQUFnQztLQUMvQkEsT0FBTyxDQUFDLFFBQVEsSUFDakIscUNBQXFDO0tBQ3BDRixJQUFJO0lBRVAseURBQXlEO0lBQ3pELG1DQUFtQztJQUNuQyxnQ0FBZ0M7SUFDaEMsTUFBTUcsa0JBQWtCO1FBQ3RCLFlBQVk7UUFDWixhQUFhO1FBQ2IsaUJBQWlCO1FBQ2pCLFlBQVk7UUFDWixhQUFhO1FBQ2IsZ0JBQWdCO1FBQ2hCLGVBQWU7UUFDZixnQkFBZ0I7UUFDaEIscUJBQXFCO1FBQ3JCLFdBQVc7UUFDWCxZQUFZO1FBQ1osZ0JBQWdCO0lBQ2xCO0lBRUEsd0RBQXdEO0lBQ3hELElBQUlBLGVBQWUsQ0FBQ0wsV0FBVyxFQUFFO1FBQy9CQSxhQUFhSyxlQUFlLENBQUNMLFdBQVc7SUFDMUM7SUFFQXBILFFBQVFDLEdBQUcsQ0FBQyxDQUFDLG1CQUFtQixFQUFFaUMsS0FBSyxNQUFNLEVBQUVrRixXQUFXLENBQUMsQ0FBQztJQUM1RCxPQUFPQTtBQUNUO0FBRUEsNERBQTREO0FBQzVELFNBQVMvQixzQkFBc0IzRCxLQUFVLEVBQUVnRyxXQUFxQjtJQUM5RCwwREFBMEQ7SUFDMUQsTUFBTTdGLFdBQVdILE1BQU1HLFFBQVEsQ0FBQ3dGLFdBQVc7SUFDM0MsTUFBTXZGLFdBQVdKLE1BQU1JLFFBQVEsQ0FBQ3VGLFdBQVc7SUFFM0MsS0FBSyxNQUFNdEUsUUFBUTJFLFlBQWE7UUFDOUIsTUFBTUMsWUFBWTVFLEtBQUtzRSxXQUFXO1FBRWxDLHFDQUFxQztRQUNyQyxJQUFJeEYsU0FBUytGLFFBQVEsQ0FBQ0QsY0FBY0EsVUFBVUMsUUFBUSxDQUFDL0YsU0FBU2dHLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHO1lBQzlFLE9BQU9uRyxNQUFNRyxRQUFRO1FBQ3ZCO1FBQ0EsSUFBSUMsU0FBUzhGLFFBQVEsQ0FBQ0QsY0FBY0EsVUFBVUMsUUFBUSxDQUFDOUYsU0FBUytGLEtBQUssQ0FBQyxJQUFJLENBQUMsRUFBRSxHQUFHO1lBQzlFLE9BQU9uRyxNQUFNSSxRQUFRO1FBQ3ZCO1FBRUEsOEJBQThCO1FBQzlCLElBQUlpQixLQUFLNkUsUUFBUSxDQUFDLGFBQWMvRixDQUFBQSxTQUFTK0YsUUFBUSxDQUFDLGFBQWE5RixTQUFTOEYsUUFBUSxDQUFDLFNBQVEsR0FBSTtZQUMzRixPQUFPL0YsU0FBUytGLFFBQVEsQ0FBQyxZQUFZbEcsTUFBTUcsUUFBUSxHQUFHSCxNQUFNSSxRQUFRO1FBQ3RFO0lBQ0Y7SUFFQSxnRUFBZ0U7SUFDaEUsT0FBTzRGLFdBQVcsQ0FBQyxFQUFFLElBQUk7QUFDM0I7QUFFQSxxQ0FBcUM7QUFDckMsU0FBUy9CLHVCQUF1QnBFLE9BQWMsRUFBRXNCLEtBQWU7SUFDN0QsTUFBTWlGLFlBQVksSUFBSXhGO0lBRXRCLDJDQUEyQztJQUMzQ08sTUFBTXFCLE9BQU8sQ0FBQ25CLENBQUFBO1FBQ1orRSxVQUFVN0UsR0FBRyxDQUFDRixNQUFNO1lBQ2xCQTtZQUNBeEIsU0FBUyxFQUFFO1lBQ1h3RyxTQUFTLElBQUk1RTtRQUNmO0lBQ0Y7SUFFQSxzREFBc0Q7SUFDdEQ1QixRQUFRMkMsT0FBTyxDQUFDTCxDQUFBQTtRQUNkLE1BQU11QixhQUFhQyxzQkFBc0J4QixPQUFPbkMsS0FBSyxFQUFFbUI7UUFDdkQsTUFBTW1GLGlCQUFpQm5GLE1BQU1xQyxJQUFJLENBQUMrQyxDQUFBQSxJQUNoQ0EsRUFBRVosV0FBVyxHQUFHTyxRQUFRLENBQUN4QyxXQUFXaUMsV0FBVyxPQUMvQ2pDLFdBQVdpQyxXQUFXLEdBQUdPLFFBQVEsQ0FBQ0ssRUFBRVosV0FBVyxRQUM1Q3hFLEtBQUssQ0FBQyxFQUFFO1FBRWIsSUFBSWlGLFVBQVVyRixHQUFHLENBQUN1RixpQkFBaUI7WUFDakNGLFVBQVVuRixHQUFHLENBQUNxRixnQkFBZ0J6RyxPQUFPLENBQUNxQixJQUFJLENBQUNpQixPQUFPQSxNQUFNO1lBQ3hEaUUsVUFBVW5GLEdBQUcsQ0FBQ3FGLGdCQUFnQkQsT0FBTyxDQUFDakYsR0FBRyxDQUFDZSxPQUFPbkMsS0FBSyxDQUFDRSxFQUFFO1FBQzNEO0lBQ0Y7SUFFQSx3QkFBd0I7SUFDeEIsT0FBTzBDLE1BQU1DLElBQUksQ0FBQ3VELFVBQVV0RCxNQUFNLElBQy9CMEQsTUFBTSxDQUFDbkIsQ0FBQUEsUUFBU0EsTUFBTXhGLE9BQU8sQ0FBQ2EsTUFBTSxHQUFHLEdBQ3ZDMEMsR0FBRyxDQUFDaUMsQ0FBQUEsUUFBVTtZQUNiaEUsTUFBTWdFLE1BQU1oRSxJQUFJO1lBQ2hCVSxXQUFXNkIsT0FBTyxDQUFDeUIsTUFBTXhGLE9BQU8sQ0FBQ21DLE1BQU0sQ0FBQyxDQUFDQyxLQUFhQyxJQUFjRCxNQUFNQyxHQUFHLEtBQUttRCxNQUFNeEYsT0FBTyxDQUFDYSxNQUFNLEVBQUVtRCxPQUFPLENBQUM7WUFDaEg0QyxZQUFZcEIsTUFBTWdCLE9BQU8sQ0FBQzNFLElBQUk7WUFDOUJnRixhQUFhckIsTUFBTXhGLE9BQU8sQ0FBQ2EsTUFBTTtRQUNuQyxJQUNDcUMsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1BLEVBQUVsQixTQUFTLEdBQUdpQixFQUFFakIsU0FBUztBQUM3QztBQUVBLGdEQUFnRDtBQUNoRCxTQUFTZ0Msd0JBQXdCbEUsT0FBYztJQUM3QyxNQUFNOEcsY0FBYyxJQUFJL0Y7SUFFeEJmLFFBQVEyQyxPQUFPLENBQUNMLENBQUFBO1FBQ2QsTUFBTTlCLE9BQU8sSUFBSXRCLEtBQUtvRCxPQUFPaEQsU0FBUztRQUN0QyxNQUFNeUgsV0FBVyxDQUFDLEVBQUV2RyxLQUFLbkIsV0FBVyxHQUFHLENBQUMsRUFBRSxDQUFDbUIsS0FBS2QsUUFBUSxLQUFLLEdBQUdkLFFBQVEsR0FBR29JLFFBQVEsQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUU3RixJQUFJLENBQUNGLFlBQVk1RixHQUFHLENBQUM2RixXQUFXO1lBQzlCRCxZQUFZcEYsR0FBRyxDQUFDcUYsVUFBVTtnQkFDeEIvRyxTQUFTLEVBQUU7Z0JBQ1h3RyxTQUFTLElBQUk1RTtZQUNmO1FBQ0Y7UUFFQWtGLFlBQVkxRixHQUFHLENBQUMyRixVQUFVL0csT0FBTyxDQUFDcUIsSUFBSSxDQUFDaUIsT0FBT0EsTUFBTTtRQUNwRHdFLFlBQVkxRixHQUFHLENBQUMyRixVQUFVUCxPQUFPLENBQUNqRixHQUFHLENBQUNlLE9BQU9uQyxLQUFLLENBQUNFLEVBQUU7SUFDdkQ7SUFFQSxPQUFPMEMsTUFBTUMsSUFBSSxDQUFDOEQsWUFBWTlFLE9BQU8sSUFDbEN1QixHQUFHLENBQUMsQ0FBQyxDQUFDMEQsT0FBT0MsS0FBSyxHQUFNO1lBQ3ZCRDtZQUNBL0UsV0FBVzZCLE9BQU8sQ0FBQ21ELEtBQUtsSCxPQUFPLENBQUNtQyxNQUFNLENBQUMsQ0FBQ0MsS0FBYUMsSUFBY0QsTUFBTUMsR0FBRyxLQUFLNkUsS0FBS2xILE9BQU8sQ0FBQ2EsTUFBTSxFQUFFbUQsT0FBTyxDQUFDO1lBQzlHNEMsWUFBWU0sS0FBS1YsT0FBTyxDQUFDM0UsSUFBSTtRQUMvQixJQUNDcUIsSUFBSSxDQUFDLENBQUNDLEdBQUdDLElBQU1ELEVBQUU4RCxLQUFLLENBQUNFLGFBQWEsQ0FBQy9ELEVBQUU2RCxLQUFLLEdBQzVDM0QsS0FBSyxDQUFDLENBQUM7QUFDWjtBQUVBLFNBQVMyQix3QkFBd0JtQyxPQUF5QjtJQUN4RCxNQUFNQyxZQUFZLElBQUl0RztJQUV0QnFHLFFBQVF6RSxPQUFPLENBQUM5QyxDQUFBQTtRQUNkLElBQUksQ0FBQ3dILFVBQVVuRyxHQUFHLENBQUNyQixPQUFPM0IsS0FBSyxHQUFHO1lBQ2hDbUosVUFBVTNGLEdBQUcsQ0FBQzdCLE9BQU8zQixLQUFLLEVBQUU7Z0JBQzFCb0osT0FBTztnQkFDUGhELGNBQWM7WUFDaEI7UUFDRjtRQUVBLE1BQU00QyxPQUFPRyxVQUFVakcsR0FBRyxDQUFDdkIsT0FBTzNCLEtBQUs7UUFDdkNnSixLQUFLSSxLQUFLO1FBQ1ZKLEtBQUs1QyxZQUFZLElBQUl6RSxPQUFPeUUsWUFBWTtJQUMxQztJQUVBLE9BQU92QixNQUFNQyxJQUFJLENBQUNxRSxVQUFVckYsT0FBTyxJQUFJdUIsR0FBRyxDQUFDLENBQUMsQ0FBQ3JGLE9BQU9nSixLQUFLLEdBQU07WUFDN0RoSjtZQUNBcUosYUFBYUwsS0FBS0ksS0FBSztZQUN2QnBGLFdBQVdrRixRQUNSVCxNQUFNLENBQUM5QixDQUFBQSxJQUFLQSxFQUFFM0csS0FBSyxLQUFLQSxPQUN4QmlFLE1BQU0sQ0FBQyxDQUFDQyxLQUFLeUMsSUFBTXpDLE1BQU15QyxFQUFFM0MsU0FBUyxFQUFFLEtBQUtnRixLQUFLSSxLQUFLO1lBQ3hEaEQsY0FBYzRDLEtBQUs1QyxZQUFZO1FBQ2pDO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9mb290cmF0ZS8uL3BhZ2VzL2FwaS9iYWxsb24tb3IudHM/ZmU3MiJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBwYWdlcy9hcGkvYmFsbG9uLW9yLnRzIC0gVmVyc2lvbiBhdmVjIGZ1c2lvbiBpbnRlbGxpZ2VudGUgZGVzIGpvdWV1cnNcbmltcG9ydCB7IE5leHRBcGlSZXF1ZXN0LCBOZXh0QXBpUmVzcG9uc2UgfSBmcm9tICduZXh0J1xuaW1wb3J0IHsgcHJpc21hIH0gZnJvbSAnLi4vLi4vbGliL3ByaXNtYSdcblxuaW50ZXJmYWNlIEJhbGxvbk9yUGxheWVyIHtcbiAgaWQ6IHN0cmluZ1xuICBuYW1lOiBzdHJpbmdcbiAgbm9ybWFsaXplZE5hbWU6IHN0cmluZ1xuICBwb3NpdGlvbnM6IHN0cmluZ1tdXG4gIHRlYW1zOiBzdHJpbmdbXVxuICBzcG9ydDogc3RyaW5nXG4gIGF2Z1JhdGluZzogbnVtYmVyXG4gIHRvdGFsUmF0aW5nczogbnVtYmVyXG4gIHRvdGFsTWF0Y2hlczogbnVtYmVyXG4gIGJlc3RNYXRjaDoge1xuICAgIGlkOiBzdHJpbmdcbiAgICByYXRpbmc6IG51bWJlclxuICAgIGhvbWVUZWFtOiBzdHJpbmdcbiAgICBhd2F5VGVhbTogc3RyaW5nXG4gICAgZGF0ZTogc3RyaW5nXG4gICAgY29tcGV0aXRpb246IHN0cmluZ1xuICAgIHRlYW06IHN0cmluZ1xuICB9XG4gIHJlY2VudE1hdGNoZXM6IEFycmF5PHtcbiAgICBtYXRjaElkOiBzdHJpbmdcbiAgICByYXRpbmc6IG51bWJlclxuICAgIGNvbW1lbnQ/OiBzdHJpbmdcbiAgICBob21lVGVhbTogc3RyaW5nXG4gICAgYXdheVRlYW06IHN0cmluZ1xuICAgIGRhdGU6IHN0cmluZ1xuICAgIGNvbXBldGl0aW9uOiBzdHJpbmdcbiAgICB0ZWFtOiBzdHJpbmdcbiAgfT5cbiAgcmF0aW5nSGlzdG9yeTogQXJyYXk8e1xuICAgIG1vbnRoOiBzdHJpbmdcbiAgICBhdmdSYXRpbmc6IG51bWJlclxuICAgIG1hdGNoQ291bnQ6IG51bWJlclxuICB9PlxuICB0ZWFtQnJlYWtkb3duOiBBcnJheTx7XG4gICAgdGVhbTogc3RyaW5nXG4gICAgYXZnUmF0aW5nOiBudW1iZXJcbiAgICBtYXRjaENvdW50OiBudW1iZXJcbiAgICByYXRpbmdDb3VudDogbnVtYmVyXG4gIH0+XG59XG5cbmV4cG9ydCBkZWZhdWx0IGFzeW5jIGZ1bmN0aW9uIGhhbmRsZXIocmVxOiBOZXh0QXBpUmVxdWVzdCwgcmVzOiBOZXh0QXBpUmVzcG9uc2UpIHtcbiAgaWYgKHJlcS5tZXRob2QgIT09ICdHRVQnKSB7XG4gICAgcmV0dXJuIHJlcy5zdGF0dXMoNDA1KS5qc29uKHsgZXJyb3I6ICdNZXRob2Qgbm90IGFsbG93ZWQnIH0pXG4gIH1cblxuICB0cnkge1xuICAgIGNvbnN0IHtcbiAgICAgIHNwb3J0ID0gJ2FsbCcsXG4gICAgICBwb3NpdGlvbiA9ICdhbGwnLCBcbiAgICAgIG1pbk1hdGNoZXMgPSAnMycsXG4gICAgICBsaW1pdCA9ICc1MCcsXG4gICAgICBwZXJpb2QgPSAnYWxsLXRpbWUnLFxuICAgICAgZXhjbHVkZUYxID0gJ2ZhbHNlJyAvLyDwn4aVIFBhcmFtw6h0cmUgcG91ciBleGNsdXJlIEYxXG4gICAgfSA9IHJlcS5xdWVyeVxuXG4gICAgY29uc29sZS5sb2coYPCfj4YgQ2FsY3VsIEJhbGxvbiBkJ09yIGF2ZWMgZnVzaW9uIGpvdWV1cnMgLSBTcG9ydDogJHtzcG9ydH0sIE1pbiBtYXRjaHM6ICR7bWluTWF0Y2hlc31gKVxuXG4gICAgLy8gMS4gQ29uc3RydWlyZSBsZXMgZmlsdHJlc1xuICAgIGxldCBzcG9ydEZpbHRlciA9IHt9XG4gICAgaWYgKHNwb3J0ICE9PSAnYWxsJykge1xuICAgICAgc3BvcnRGaWx0ZXIgPSB7IHNwb3J0OiBzcG9ydC50b1N0cmluZygpLnRvVXBwZXJDYXNlKCkgfVxuICAgIH0gZWxzZSBpZiAoZXhjbHVkZUYxID09PSAndHJ1ZScpIHtcbiAgICAgIC8vIPCfmqsgRXhjbHVyZSBGMSBkdSBCYWxsb24gZCdPciBjbGFzc2lxdWVcbiAgICAgIHNwb3J0RmlsdGVyID0geyBcbiAgICAgICAgc3BvcnQ6IHsgXG4gICAgICAgICAgbm90OiAnRjEnIFxuICAgICAgICB9IFxuICAgICAgfVxuICAgIH1cblxuICAgIGxldCBwb3NpdGlvbkZpbHRlciA9IHt9XG4gICAgaWYgKHBvc2l0aW9uICE9PSAnYWxsJykge1xuICAgICAgcG9zaXRpb25GaWx0ZXIgPSB7IHBvc2l0aW9uOiBwb3NpdGlvbi50b1N0cmluZygpIH1cbiAgICB9XG5cbiAgICAvLyAyLiBGaWx0cmUgcGFyIHDDqXJpb2RlXG4gICAgbGV0IGRhdGVGaWx0ZXIgPSB7fVxuICAgIGNvbnN0IG5vdyA9IG5ldyBEYXRlKClcbiAgICBcbiAgICBzd2l0Y2ggKHBlcmlvZCkge1xuICAgICAgY2FzZSAndGhpcy15ZWFyJzpcbiAgICAgICAgY29uc3QgeWVhckFnbyA9IG5ldyBEYXRlKClcbiAgICAgICAgeWVhckFnby5zZXRGdWxsWWVhcihub3cuZ2V0RnVsbFllYXIoKSAtIDEpXG4gICAgICAgIGRhdGVGaWx0ZXIgPSB7IGNyZWF0ZWRBdDogeyBndGU6IHllYXJBZ28gfSB9XG4gICAgICAgIGJyZWFrXG4gICAgICBjYXNlICd0aGlzLXNlYXNvbic6XG4gICAgICAgIGNvbnN0IHNlYXNvblN0YXJ0ID0gbmV3IERhdGUoKVxuICAgICAgICBzZWFzb25TdGFydC5zZXRNb250aCg4KSAvLyBTZXB0ZW1icmVcbiAgICAgICAgaWYgKG5vdy5nZXRNb250aCgpIDwgOCkge1xuICAgICAgICAgIHNlYXNvblN0YXJ0LnNldEZ1bGxZZWFyKG5vdy5nZXRGdWxsWWVhcigpIC0gMSlcbiAgICAgICAgfVxuICAgICAgICBkYXRlRmlsdGVyID0geyBjcmVhdGVkQXQ6IHsgZ3RlOiBzZWFzb25TdGFydCB9IH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGNhc2UgJ2xhc3QtNi1tb250aHMnOlxuICAgICAgICBjb25zdCBzaXhNb250aHNBZ28gPSBuZXcgRGF0ZSgpXG4gICAgICAgIHNpeE1vbnRoc0Fnby5zZXRNb250aChub3cuZ2V0TW9udGgoKSAtIDYpXG4gICAgICAgIGRhdGVGaWx0ZXIgPSB7IGNyZWF0ZWRBdDogeyBndGU6IHNpeE1vbnRoc0FnbyB9IH1cbiAgICAgICAgYnJlYWtcbiAgICAgIGRlZmF1bHQ6IC8vICdhbGwtdGltZSdcbiAgICAgICAgYnJlYWtcbiAgICB9XG5cbiAgICAvLyAzLiBSw6ljdXDDqXJlciBUT1VTIGxlcyBqb3VldXJzIGF2ZWMgbGV1cnMgbm90ZXNcbiAgICBjb25zdCBwbGF5ZXJzV2l0aFJhdGluZ3MgPSBhd2FpdCBwcmlzbWEucGxheWVyLmZpbmRNYW55KHtcbiAgICAgIHdoZXJlOiB7XG4gICAgICAgIC4uLnNwb3J0RmlsdGVyLFxuICAgICAgICByYXRpbmdzOiB7XG4gICAgICAgICAgc29tZToge1xuICAgICAgICAgICAgLi4uZGF0ZUZpbHRlclxuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSxcbiAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgcmF0aW5nczoge1xuICAgICAgICAgIHdoZXJlOiBkYXRlRmlsdGVyLFxuICAgICAgICAgIGluY2x1ZGU6IHtcbiAgICAgICAgICAgIG1hdGNoOiB7XG4gICAgICAgICAgICAgIHNlbGVjdDoge1xuICAgICAgICAgICAgICAgIGlkOiB0cnVlLFxuICAgICAgICAgICAgICAgIGhvbWVUZWFtOiB0cnVlLFxuICAgICAgICAgICAgICAgIGF3YXlUZWFtOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRhdGU6IHRydWUsXG4gICAgICAgICAgICAgICAgY29tcGV0aXRpb246IHRydWUsXG4gICAgICAgICAgICAgICAgc3BvcnQ6IHRydWVcbiAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHVzZXI6IHtcbiAgICAgICAgICAgICAgc2VsZWN0OiB7XG4gICAgICAgICAgICAgICAgaWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgbmFtZTogdHJ1ZVxuICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgICAgfSxcbiAgICAgICAgICBvcmRlckJ5OiB7IGNyZWF0ZWRBdDogJ2Rlc2MnIH1cbiAgICAgICAgfVxuICAgICAgfVxuICAgIH0pXG5cbiAgICBjb25zb2xlLmxvZyhg8J+RpSAke3BsYXllcnNXaXRoUmF0aW5ncy5sZW5ndGh9IGpvdWV1cnMgYnJ1dHMgcsOpY3Vww6lyw6lzYClcblxuICAgIC8vIDQuIPCfp6AgRlVTSU9OIElOVEVMTElHRU5URSBERVMgSk9VRVVSU1xuICAgIGNvbnN0IGZ1c2VkUGxheWVycyA9IG5ldyBNYXA8c3RyaW5nLCBhbnk+KClcblxuICAgIGZvciAoY29uc3QgcGxheWVyIG9mIHBsYXllcnNXaXRoUmF0aW5ncykge1xuICAgICAgaWYgKHBsYXllci5yYXRpbmdzLmxlbmd0aCA9PT0gMCkgY29udGludWVcblxuICAgICAgLy8gTm9ybWFsaXNlciBsZSBub20gcG91ciBsYSBmdXNpb25cbiAgICAgIGNvbnN0IG5vcm1hbGl6ZWROYW1lID0gbm9ybWFsaXplUGxheWVyTmFtZShwbGF5ZXIubmFtZSlcbiAgICAgIFxuICAgICAgLy8gU2kgbGUgam91ZXVyIGV4aXN0ZSBkw6lqw6AgKG3Dqm1lIG5vbSBub3JtYWxpc8OpKSwgZnVzaW9ubmVyXG4gICAgICBpZiAoZnVzZWRQbGF5ZXJzLmhhcyhub3JtYWxpemVkTmFtZSkpIHtcbiAgICAgICAgY29uc3QgZXhpc3RpbmdQbGF5ZXIgPSBmdXNlZFBsYXllcnMuZ2V0KG5vcm1hbGl6ZWROYW1lKVxuICAgICAgICBcbiAgICAgICAgLy8gRnVzaW9ubmVyIGxlcyBkb25uw6llc1xuICAgICAgICBleGlzdGluZ1BsYXllci5yYXRpbmdzLnB1c2goLi4ucGxheWVyLnJhdGluZ3MpXG4gICAgICAgIGV4aXN0aW5nUGxheWVyLnRlYW1zLmFkZChwbGF5ZXIudGVhbSlcbiAgICAgICAgaWYgKHBsYXllci5wb3NpdGlvbikge1xuICAgICAgICAgIGV4aXN0aW5nUGxheWVyLnBvc2l0aW9ucy5hZGQocGxheWVyLnBvc2l0aW9uKVxuICAgICAgICB9XG4gICAgICAgIFxuICAgICAgICBjb25zb2xlLmxvZyhg8J+UlyBGdXNpb246ICR7cGxheWVyLm5hbWV9ICgke3BsYXllci50ZWFtfSkgYXZlYyAke2V4aXN0aW5nUGxheWVyLm5hbWV9YClcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIC8vIE5vdXZlYXUgam91ZXVyXG4gICAgICAgIGZ1c2VkUGxheWVycy5zZXQobm9ybWFsaXplZE5hbWUsIHtcbiAgICAgICAgICBvcmlnaW5hbElkOiBwbGF5ZXIuaWQsXG4gICAgICAgICAgbmFtZTogcGxheWVyLm5hbWUsIC8vIEdhcmRlciBsZSBub20gb3JpZ2luYWwgZHUgcHJlbWllclxuICAgICAgICAgIG5vcm1hbGl6ZWROYW1lLFxuICAgICAgICAgIHNwb3J0OiBwbGF5ZXIuc3BvcnQsXG4gICAgICAgICAgdGVhbXM6IG5ldyBTZXQoW3BsYXllci50ZWFtXSksXG4gICAgICAgICAgcG9zaXRpb25zOiBuZXcgU2V0KHBsYXllci5wb3NpdGlvbiA/IFtwbGF5ZXIucG9zaXRpb25dIDogW10pLFxuICAgICAgICAgIHJhdGluZ3M6IFsuLi5wbGF5ZXIucmF0aW5nc11cbiAgICAgICAgfSlcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zb2xlLmxvZyhg8J+UlyBBcHLDqHMgZnVzaW9uOiAke2Z1c2VkUGxheWVycy5zaXplfSBqb3VldXJzIHVuaXF1ZXNgKVxuXG4gICAgLy8gNS4gQ2FsY3VsZXIgbGVzIHN0YXRpc3RpcXVlcyBwb3VyIGNoYXF1ZSBqb3VldXIgZnVzaW9ubsOpXG4gICAgY29uc3QgYmFsbG9uT3JDYW5kaWRhdGVzOiBCYWxsb25PclBsYXllcltdID0gW11cblxuICAgIGZvciAoY29uc3QgW25vcm1hbGl6ZWROYW1lLCBmdXNlZFBsYXllcl0gb2YgZnVzZWRQbGF5ZXJzLmVudHJpZXMoKSkge1xuICAgICAgY29uc3QgcmF0aW5ncyA9IGZ1c2VkUGxheWVyLnJhdGluZ3NcbiAgICAgIFxuICAgICAgaWYgKHJhdGluZ3MubGVuZ3RoIDwgcGFyc2VJbnQobWluTWF0Y2hlcy50b1N0cmluZygpKSkge1xuICAgICAgICBjb250aW51ZVxuICAgICAgfVxuXG4gICAgICAvLyBGaWx0cmUgcG9zaXRpb24gYXByw6hzIGZ1c2lvblxuICAgICAgaWYgKHBvc2l0aW9uICE9PSAnYWxsJyAmJiAhZnVzZWRQbGF5ZXIucG9zaXRpb25zLmhhcyhwb3NpdGlvbikpIHtcbiAgICAgICAgY29udGludWVcbiAgICAgIH1cblxuICAgICAgLy8gQ2FsY3VsZXIgbGEgbW95ZW5uZSBnbG9iYWxlXG4gICAgICBjb25zdCBhdmdSYXRpbmcgPSByYXRpbmdzLnJlZHVjZSgoc3VtOiBudW1iZXIsIHI6IGFueSkgPT4gc3VtICsgci5yYXRpbmcsIDApIC8gcmF0aW5ncy5sZW5ndGhcbiAgICAgIFxuICAgICAgLy8gVHJvdXZlciBsZSBtZWlsbGV1ciBtYXRjaFxuICAgICAgY29uc3QgYmVzdFJhdGluZyA9IHJhdGluZ3MucmVkdWNlKChiZXN0OiBhbnksIGN1cnJlbnQ6IGFueSkgPT4gXG4gICAgICAgIGN1cnJlbnQucmF0aW5nID4gYmVzdC5yYXRpbmcgPyBjdXJyZW50IDogYmVzdFxuICAgICAgKVxuXG4gICAgICAvLyBSw6ljdXDDqXJlciBsZXMgbWF0Y2hzIHVuaXF1ZXMgYXZlYyBtb3llbm5lIHBhciBtYXRjaFxuICAgICAgY29uc3QgdW5pcXVlTWF0Y2hlcyA9IG5ldyBNYXAoKVxuICAgICAgcmF0aW5ncy5mb3JFYWNoKChyYXRpbmc6IGFueSkgPT4ge1xuICAgICAgICBjb25zdCBtYXRjaElkID0gcmF0aW5nLm1hdGNoLmlkXG4gICAgICAgIGlmICghdW5pcXVlTWF0Y2hlcy5oYXMobWF0Y2hJZCkpIHtcbiAgICAgICAgICB1bmlxdWVNYXRjaGVzLnNldChtYXRjaElkLCB7XG4gICAgICAgICAgICBtYXRjaDogcmF0aW5nLm1hdGNoLFxuICAgICAgICAgICAgcmF0aW5nczogW11cbiAgICAgICAgICB9KVxuICAgICAgICB9XG4gICAgICAgIHVuaXF1ZU1hdGNoZXMuZ2V0KG1hdGNoSWQpLnJhdGluZ3MucHVzaChyYXRpbmcpXG4gICAgICB9KVxuXG4gICAgICBjb25zdCB0b3RhbE1hdGNoZXMgPSB1bmlxdWVNYXRjaGVzLnNpemVcblxuICAgICAgLy8gQ2FsY3VsZXIgbGVzIDUgbWF0Y2hzIGxlcyBwbHVzIHLDqWNlbnRzXG4gICAgICBjb25zdCByZWNlbnRNYXRjaGVzID0gQXJyYXkuZnJvbSh1bmlxdWVNYXRjaGVzLnZhbHVlcygpKVxuICAgICAgICAuc29ydCgoYTogYW55LCBiOiBhbnkpID0+IG5ldyBEYXRlKGIubWF0Y2guZGF0ZSkuZ2V0VGltZSgpIC0gbmV3IERhdGUoYS5tYXRjaC5kYXRlKS5nZXRUaW1lKCkpXG4gICAgICAgIC5zbGljZSgwLCA1KVxuICAgICAgICAubWFwKChtYXRjaERhdGE6IGFueSkgPT4ge1xuICAgICAgICAgIGNvbnN0IG1hdGNoQXZnUmF0aW5nID0gbWF0Y2hEYXRhLnJhdGluZ3MucmVkdWNlKChzdW06IG51bWJlciwgcjogYW55KSA9PiBzdW0gKyByLnJhdGluZywgMCkgLyBtYXRjaERhdGEucmF0aW5ncy5sZW5ndGhcbiAgICAgICAgICBjb25zdCBiZXN0Q29tbWVudCA9IG1hdGNoRGF0YS5yYXRpbmdzLmZpbmQoKHI6IGFueSkgPT4gci5jb21tZW50KT8uY29tbWVudFxuICAgICAgICAgIFxuICAgICAgICAgIC8vIETDqXRlcm1pbmVyIGwnw6lxdWlwZSBkdSBqb3VldXIgcG91ciBjZSBtYXRjaFxuICAgICAgICAgIGNvbnN0IHBsYXllclRlYW0gPSBnZXRQbGF5ZXJUZWFtRm9yTWF0Y2gobWF0Y2hEYXRhLm1hdGNoLCBBcnJheS5mcm9tKGZ1c2VkUGxheWVyLnRlYW1zKSlcbiAgICAgICAgICBcbiAgICAgICAgICByZXR1cm4ge1xuICAgICAgICAgICAgbWF0Y2hJZDogbWF0Y2hEYXRhLm1hdGNoLmlkLFxuICAgICAgICAgICAgcmF0aW5nOiBOdW1iZXIobWF0Y2hBdmdSYXRpbmcudG9GaXhlZCgxKSksXG4gICAgICAgICAgICBjb21tZW50OiBiZXN0Q29tbWVudCxcbiAgICAgICAgICAgIGhvbWVUZWFtOiBtYXRjaERhdGEubWF0Y2guaG9tZVRlYW0sXG4gICAgICAgICAgICBhd2F5VGVhbTogbWF0Y2hEYXRhLm1hdGNoLmF3YXlUZWFtLFxuICAgICAgICAgICAgZGF0ZTogbWF0Y2hEYXRhLm1hdGNoLmRhdGUsXG4gICAgICAgICAgICBjb21wZXRpdGlvbjogbWF0Y2hEYXRhLm1hdGNoLmNvbXBldGl0aW9uLFxuICAgICAgICAgICAgdGVhbTogcGxheWVyVGVhbVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgLy8gQ2FsY3VsZXIgbCdoaXN0b3JpcXVlIG1lbnN1ZWxcbiAgICAgIGNvbnN0IHJhdGluZ0hpc3RvcnkgPSBjYWxjdWxhdGVNb250aGx5SGlzdG9yeShyYXRpbmdzKVxuXG4gICAgICAvLyBDYWxjdWxlciBsYSByw6lwYXJ0aXRpb24gcGFyIMOpcXVpcGVcbiAgICAgIGNvbnN0IHRlYW1CcmVha2Rvd24gPSBjYWxjdWxhdGVUZWFtQnJlYWtkb3duKHJhdGluZ3MsIEFycmF5LmZyb20oZnVzZWRQbGF5ZXIudGVhbXMpKVxuXG4gICAgICAvLyBEw6l0ZXJtaW5lciBsJ8OpcXVpcGUgZHUgbWVpbGxldXIgbWF0Y2hcbiAgICAgIGNvbnN0IGJlc3RNYXRjaFRlYW0gPSBnZXRQbGF5ZXJUZWFtRm9yTWF0Y2goYmVzdFJhdGluZy5tYXRjaCwgQXJyYXkuZnJvbShmdXNlZFBsYXllci50ZWFtcykpXG5cbiAgICAgIGJhbGxvbk9yQ2FuZGlkYXRlcy5wdXNoKHtcbiAgICAgICAgaWQ6IGBmdXNlZF8ke25vcm1hbGl6ZWROYW1lfWAsXG4gICAgICAgIG5hbWU6IGZ1c2VkUGxheWVyLm5hbWUsXG4gICAgICAgIG5vcm1hbGl6ZWROYW1lLFxuICAgICAgICBwb3NpdGlvbnM6IEFycmF5LmZyb20oZnVzZWRQbGF5ZXIucG9zaXRpb25zKSxcbiAgICAgICAgdGVhbXM6IEFycmF5LmZyb20oZnVzZWRQbGF5ZXIudGVhbXMpLFxuICAgICAgICBzcG9ydDogZnVzZWRQbGF5ZXIuc3BvcnQsXG4gICAgICAgIGF2Z1JhdGluZzogTnVtYmVyKGF2Z1JhdGluZy50b0ZpeGVkKDIpKSxcbiAgICAgICAgdG90YWxSYXRpbmdzOiByYXRpbmdzLmxlbmd0aCxcbiAgICAgICAgdG90YWxNYXRjaGVzLFxuICAgICAgICBiZXN0TWF0Y2g6IHtcbiAgICAgICAgICBpZDogYmVzdFJhdGluZy5tYXRjaC5pZCxcbiAgICAgICAgICByYXRpbmc6IGJlc3RSYXRpbmcucmF0aW5nLFxuICAgICAgICAgIGhvbWVUZWFtOiBiZXN0UmF0aW5nLm1hdGNoLmhvbWVUZWFtLFxuICAgICAgICAgIGF3YXlUZWFtOiBiZXN0UmF0aW5nLm1hdGNoLmF3YXlUZWFtLFxuICAgICAgICAgIGRhdGU6IGJlc3RSYXRpbmcubWF0Y2guZGF0ZSxcbiAgICAgICAgICBjb21wZXRpdGlvbjogYmVzdFJhdGluZy5tYXRjaC5jb21wZXRpdGlvbixcbiAgICAgICAgICB0ZWFtOiBiZXN0TWF0Y2hUZWFtXG4gICAgICAgIH0sXG4gICAgICAgIHJlY2VudE1hdGNoZXMsXG4gICAgICAgIHJhdGluZ0hpc3RvcnksXG4gICAgICAgIHRlYW1CcmVha2Rvd25cbiAgICAgIH0pXG4gICAgfVxuXG4gICAgLy8gNi4gVHJpZXIgcGFyIG1veWVubmUgZGVzIG5vdGVzXG4gICAgYmFsbG9uT3JDYW5kaWRhdGVzLnNvcnQoKGEsIGIpID0+IHtcbiAgICAgIGlmIChNYXRoLmFicyhhLmF2Z1JhdGluZyAtIGIuYXZnUmF0aW5nKSA8IDAuMDEpIHtcbiAgICAgICAgcmV0dXJuIGIudG90YWxNYXRjaGVzIC0gYS50b3RhbE1hdGNoZXNcbiAgICAgIH1cbiAgICAgIHJldHVybiBiLmF2Z1JhdGluZyAtIGEuYXZnUmF0aW5nXG4gICAgfSlcblxuICAgIC8vIDcuIExpbWl0ZXIgbGVzIHLDqXN1bHRhdHNcbiAgICBjb25zdCB0b3BQbGF5ZXJzID0gYmFsbG9uT3JDYW5kaWRhdGVzLnNsaWNlKDAsIHBhcnNlSW50KGxpbWl0LnRvU3RyaW5nKCkpKVxuXG4gICAgLy8gOC4gU3RhdGlzdGlxdWVzIGdsb2JhbGVzXG4gICAgY29uc3QgZ2xvYmFsU3RhdHMgPSB7XG4gICAgICB0b3RhbFBsYXllcnM6IGJhbGxvbk9yQ2FuZGlkYXRlcy5sZW5ndGgsXG4gICAgICB0b3RhbFJhdGluZ3M6IGJhbGxvbk9yQ2FuZGlkYXRlcy5yZWR1Y2UoKHN1bSwgcCkgPT4gc3VtICsgcC50b3RhbFJhdGluZ3MsIDApLFxuICAgICAgdG90YWxNYXRjaGVzOiBiYWxsb25PckNhbmRpZGF0ZXMucmVkdWNlKChzdW0sIHApID0+IHN1bSArIHAudG90YWxNYXRjaGVzLCAwKSxcbiAgICAgIGF2Z1JhdGluZ0dsb2JhbDogYmFsbG9uT3JDYW5kaWRhdGVzLmxlbmd0aCA+IDAgXG4gICAgICAgID8gYmFsbG9uT3JDYW5kaWRhdGVzLnJlZHVjZSgoc3VtLCBwKSA9PiBzdW0gKyBwLmF2Z1JhdGluZywgMCkgLyBiYWxsb25PckNhbmRpZGF0ZXMubGVuZ3RoIFxuICAgICAgICA6IDAsXG4gICAgICB0b3BSYXRpbmc6IHRvcFBsYXllcnNbMF0/LmF2Z1JhdGluZyB8fCAwLFxuICAgICAgc3BvcnRCcmVha2Rvd246IGNhbGN1bGF0ZVNwb3J0QnJlYWtkb3duKGJhbGxvbk9yQ2FuZGlkYXRlcyksXG4gICAgICBmdXNpb25TdGF0czoge1xuICAgICAgICBvcmlnaW5hbFBsYXllcnM6IHBsYXllcnNXaXRoUmF0aW5ncy5sZW5ndGgsXG4gICAgICAgIGZ1c2VkUGxheWVyczogYmFsbG9uT3JDYW5kaWRhdGVzLmxlbmd0aCxcbiAgICAgICAgZnVzaW9uUmVkdWN0aW9uOiBwbGF5ZXJzV2l0aFJhdGluZ3MubGVuZ3RoIC0gYmFsbG9uT3JDYW5kaWRhdGVzLmxlbmd0aFxuICAgICAgfVxuICAgIH1cblxuICAgIGNvbnNvbGUubG9nKGDwn4+GIEJhbGxvbiBkJ09yIGF2ZWMgZnVzaW9uIGNhbGN1bMOpOmApXG4gICAgY29uc29sZS5sb2coYCAgIC0gJHtwbGF5ZXJzV2l0aFJhdGluZ3MubGVuZ3RofSBqb3VldXJzIG9yaWdpbmF1eGApXG4gICAgY29uc29sZS5sb2coYCAgIC0gJHtiYWxsb25PckNhbmRpZGF0ZXMubGVuZ3RofSBqb3VldXJzIGFwcsOocyBmdXNpb25gKVxuICAgIGNvbnNvbGUubG9nKGAgICAtIExlYWRlcjogJHt0b3BQbGF5ZXJzWzBdPy5uYW1lfSAoJHt0b3BQbGF5ZXJzWzBdPy5hdmdSYXRpbmd9LzEwKWApXG4gICAgY29uc29sZS5sb2coYCAgIC0gw4lxdWlwZXM6ICR7dG9wUGxheWVyc1swXT8udGVhbXMuam9pbignLCAnKX1gKVxuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIGJhbGxvbk9yOiB0b3BQbGF5ZXJzLFxuICAgICAgc3RhdHM6IGdsb2JhbFN0YXRzLFxuICAgICAgZmlsdGVyczoge1xuICAgICAgICBzcG9ydCxcbiAgICAgICAgcG9zaXRpb24sXG4gICAgICAgIHBlcmlvZCxcbiAgICAgICAgbWluTWF0Y2hlczogcGFyc2VJbnQobWluTWF0Y2hlcy50b1N0cmluZygpKVxuICAgICAgfVxuICAgIH0pXG5cbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCfinYwgRXJyZXVyIEJhbGxvbiBkXFwnT3IgYXZlYyBmdXNpb246JywgZXJyb3IpXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBlcnJvcjogJ0VycmV1ciBzZXJ2ZXVyJyxcbiAgICAgIGRldGFpbHM6IGVycm9yIGluc3RhbmNlb2YgRXJyb3IgPyBlcnJvci5tZXNzYWdlIDogJ0VycmV1ciBpbmNvbm51ZSdcbiAgICB9KVxuICB9XG59XG5cbi8vIPCfp6AgRm9uY3Rpb24gZGUgbm9ybWFsaXNhdGlvbiBpbnRlbGxpZ2VudGUgZGVzIG5vbXNcbmZ1bmN0aW9uIG5vcm1hbGl6ZVBsYXllck5hbWUobmFtZTogc3RyaW5nKTogc3RyaW5nIHtcbiAgbGV0IG5vcm1hbGl6ZWQgPSBuYW1lXG4gICAgLnRvTG93ZXJDYXNlKClcbiAgICAudHJpbSgpXG4gICAgLy8gU3VwcHJpbWVyIGxlcyBhY2NlbnRzXG4gICAgLm5vcm1hbGl6ZSgnTkZEJykucmVwbGFjZSgvW1xcdTAzMDAtXFx1MDM2Zl0vZywgJycpXG4gICAgLy8gU3VwcHJpbWVyIGxlcyBjYXJhY3TDqHJlcyBzcMOpY2lhdXggc2F1ZiBlc3BhY2VzIGV0IHRpcmV0c1xuICAgIC5yZXBsYWNlKC9bXmEtelxccy1dL2csICcnKVxuICAgIC8vIFN1cHByaW1lciBsZXMgZG91YmxlcyBlc3BhY2VzXG4gICAgLnJlcGxhY2UoL1xccysvZywgJyAnKVxuICAgIC8vIFN1cHByaW1lciBsZXMgZXNwYWNlcyBlbiBkw6lidXQvZmluXG4gICAgLnRyaW0oKVxuXG4gIC8vIPCflI0gTm9ybWFsaXNhdGlvbiBzcMOpY2lhbGUgcG91ciBsZXMgbm9tcyBhdmVjIGluaXRpYWxlc1xuICAvLyBcIksuIE1iYXBww6lcIiAtPiBcImt5bGlhbiBtYmFwcGVcIiAgXG4gIC8vIFwiUi4gQ2hlcmtpXCIgLT4gXCJyYXlhbiBjaGVya2lcIlxuICBjb25zdCBpbml0aWFsTWFwcGluZ3MgPSB7XG4gICAgJ2sgbWJhcHBlJzogJ2t5bGlhbiBtYmFwcGUnLFxuICAgICdrLiBtYmFwcGUnOiAna3lsaWFuIG1iYXBwZScsXG4gICAgJ2t5bGlhbiBtYmFwcGUnOiAna3lsaWFuIG1iYXBwZScsXG4gICAgJ3IgY2hlcmtpJzogJ3JheWFuIGNoZXJraScsIFxuICAgICdyLiBjaGVya2knOiAncmF5YW4gY2hlcmtpJyxcbiAgICAncmF5YW4gY2hlcmtpJzogJ3JheWFuIGNoZXJraScsXG4gICAgJ2EgZ3JpZXptYW5uJzogJ2FudG9pbmUgZ3JpZXptYW5uJyxcbiAgICAnYS4gZ3JpZXptYW5uJzogJ2FudG9pbmUgZ3JpZXptYW5uJyxcbiAgICAnYW50b2luZSBncmllem1hbm4nOiAnYW50b2luZSBncmllem1hbm4nLFxuICAgICdsIGphbWVzJzogJ2xlYnJvbiBqYW1lcycsXG4gICAgJ2wuIGphbWVzJzogJ2xlYnJvbiBqYW1lcycsXG4gICAgJ2xlYnJvbiBqYW1lcyc6ICdsZWJyb24gamFtZXMnXG4gIH1cblxuICAvLyBWw6lyaWZpZXIgc2kgb24gYSB1bmUgY29ycmVzcG9uZGFuY2UgZGFucyBsZXMgbWFwcGluZ3NcbiAgaWYgKGluaXRpYWxNYXBwaW5nc1tub3JtYWxpemVkXSkge1xuICAgIG5vcm1hbGl6ZWQgPSBpbml0aWFsTWFwcGluZ3Nbbm9ybWFsaXplZF1cbiAgfVxuXG4gIGNvbnNvbGUubG9nKGDwn5SNIE5vcm1hbGlzYXRpb246IFwiJHtuYW1lfVwiIC0+IFwiJHtub3JtYWxpemVkfVwiYClcbiAgcmV0dXJuIG5vcm1hbGl6ZWRcbn1cblxuLy8gRm9uY3Rpb24gcG91ciBkw6l0ZXJtaW5lciBsJ8OpcXVpcGUgZHUgam91ZXVyIGRhbnMgdW4gbWF0Y2hcbmZ1bmN0aW9uIGdldFBsYXllclRlYW1Gb3JNYXRjaChtYXRjaDogYW55LCBwbGF5ZXJUZWFtczogc3RyaW5nW10pOiBzdHJpbmcge1xuICAvLyBFc3NheWVyIGRlIGZhaXJlIGNvcnJlc3BvbmRyZSBhdmVjIGxlcyDDqXF1aXBlcyBkdSBtYXRjaFxuICBjb25zdCBob21lVGVhbSA9IG1hdGNoLmhvbWVUZWFtLnRvTG93ZXJDYXNlKClcbiAgY29uc3QgYXdheVRlYW0gPSBtYXRjaC5hd2F5VGVhbS50b0xvd2VyQ2FzZSgpXG4gIFxuICBmb3IgKGNvbnN0IHRlYW0gb2YgcGxheWVyVGVhbXMpIHtcbiAgICBjb25zdCB0ZWFtTG93ZXIgPSB0ZWFtLnRvTG93ZXJDYXNlKClcbiAgICBcbiAgICAvLyBDb3JyZXNwb25kYW5jZSBleGFjdGUgb3UgcGFydGllbGxlXG4gICAgaWYgKGhvbWVUZWFtLmluY2x1ZGVzKHRlYW1Mb3dlcikgfHwgdGVhbUxvd2VyLmluY2x1ZGVzKGhvbWVUZWFtLnNwbGl0KCcgJylbMF0pKSB7XG4gICAgICByZXR1cm4gbWF0Y2guaG9tZVRlYW1cbiAgICB9XG4gICAgaWYgKGF3YXlUZWFtLmluY2x1ZGVzKHRlYW1Mb3dlcikgfHwgdGVhbUxvd2VyLmluY2x1ZGVzKGF3YXlUZWFtLnNwbGl0KCcgJylbMF0pKSB7XG4gICAgICByZXR1cm4gbWF0Y2guYXdheVRlYW1cbiAgICB9XG4gICAgXG4gICAgLy8gUG91ciBsZXMgw6lxdWlwZXMgbmF0aW9uYWxlc1xuICAgIGlmICh0ZWFtLmluY2x1ZGVzKCdGcmFuY2UnKSAmJiAoaG9tZVRlYW0uaW5jbHVkZXMoJ2ZyYW5jZScpIHx8IGF3YXlUZWFtLmluY2x1ZGVzKCdmcmFuY2UnKSkpIHtcbiAgICAgIHJldHVybiBob21lVGVhbS5pbmNsdWRlcygnZnJhbmNlJykgPyBtYXRjaC5ob21lVGVhbSA6IG1hdGNoLmF3YXlUZWFtXG4gICAgfVxuICB9XG4gIFxuICAvLyBTaSBhdWN1bmUgY29ycmVzcG9uZGFuY2UsIHJldG91cm5lciBsYSBwcmVtacOocmUgw6lxdWlwZSBjb25udWVcbiAgcmV0dXJuIHBsYXllclRlYW1zWzBdIHx8ICfDiXF1aXBlIGluY29ubnVlJ1xufVxuXG4vLyBDYWxjdWxlciBsYSByw6lwYXJ0aXRpb24gcGFyIMOpcXVpcGVcbmZ1bmN0aW9uIGNhbGN1bGF0ZVRlYW1CcmVha2Rvd24ocmF0aW5nczogYW55W10sIHRlYW1zOiBzdHJpbmdbXSkge1xuICBjb25zdCB0ZWFtU3RhdHMgPSBuZXcgTWFwKClcbiAgXG4gIC8vIEluaXRpYWxpc2VyIGxlcyBzdGF0cyBwb3VyIGNoYXF1ZSDDqXF1aXBlXG4gIHRlYW1zLmZvckVhY2godGVhbSA9PiB7XG4gICAgdGVhbVN0YXRzLnNldCh0ZWFtLCB7XG4gICAgICB0ZWFtLFxuICAgICAgcmF0aW5nczogW10sXG4gICAgICBtYXRjaGVzOiBuZXcgU2V0KClcbiAgICB9KVxuICB9KVxuICBcbiAgLy8gUsOpcGFydGlyIGxlcyByYXRpbmdzIHBhciDDqXF1aXBlIChiYXPDqSBzdXIgbGUgbWF0Y2gpXG4gIHJhdGluZ3MuZm9yRWFjaChyYXRpbmcgPT4ge1xuICAgIGNvbnN0IHBsYXllclRlYW0gPSBnZXRQbGF5ZXJUZWFtRm9yTWF0Y2gocmF0aW5nLm1hdGNoLCB0ZWFtcylcbiAgICBjb25zdCBub3JtYWxpemVkVGVhbSA9IHRlYW1zLmZpbmQodCA9PiBcbiAgICAgIHQudG9Mb3dlckNhc2UoKS5pbmNsdWRlcyhwbGF5ZXJUZWFtLnRvTG93ZXJDYXNlKCkpIHx8IFxuICAgICAgcGxheWVyVGVhbS50b0xvd2VyQ2FzZSgpLmluY2x1ZGVzKHQudG9Mb3dlckNhc2UoKSlcbiAgICApIHx8IHRlYW1zWzBdXG4gICAgXG4gICAgaWYgKHRlYW1TdGF0cy5oYXMobm9ybWFsaXplZFRlYW0pKSB7XG4gICAgICB0ZWFtU3RhdHMuZ2V0KG5vcm1hbGl6ZWRUZWFtKS5yYXRpbmdzLnB1c2gocmF0aW5nLnJhdGluZylcbiAgICAgIHRlYW1TdGF0cy5nZXQobm9ybWFsaXplZFRlYW0pLm1hdGNoZXMuYWRkKHJhdGluZy5tYXRjaC5pZClcbiAgICB9XG4gIH0pXG4gIFxuICAvLyBDYWxjdWxlciBsZXMgbW95ZW5uZXNcbiAgcmV0dXJuIEFycmF5LmZyb20odGVhbVN0YXRzLnZhbHVlcygpKVxuICAgIC5maWx0ZXIoc3RhdHMgPT4gc3RhdHMucmF0aW5ncy5sZW5ndGggPiAwKVxuICAgIC5tYXAoc3RhdHMgPT4gKHtcbiAgICAgIHRlYW06IHN0YXRzLnRlYW0sXG4gICAgICBhdmdSYXRpbmc6IE51bWJlcigoc3RhdHMucmF0aW5ncy5yZWR1Y2UoKHN1bTogbnVtYmVyLCByOiBudW1iZXIpID0+IHN1bSArIHIsIDApIC8gc3RhdHMucmF0aW5ncy5sZW5ndGgpLnRvRml4ZWQoMikpLFxuICAgICAgbWF0Y2hDb3VudDogc3RhdHMubWF0Y2hlcy5zaXplLFxuICAgICAgcmF0aW5nQ291bnQ6IHN0YXRzLnJhdGluZ3MubGVuZ3RoXG4gICAgfSkpXG4gICAgLnNvcnQoKGEsIGIpID0+IGIuYXZnUmF0aW5nIC0gYS5hdmdSYXRpbmcpXG59XG5cbi8vIEZvbmN0aW9ucyB1dGlsaXRhaXJlcyBleGlzdGFudGVzIChpbmNoYW5nw6llcylcbmZ1bmN0aW9uIGNhbGN1bGF0ZU1vbnRobHlIaXN0b3J5KHJhdGluZ3M6IGFueVtdKTogQXJyYXk8e21vbnRoOiBzdHJpbmcsIGF2Z1JhdGluZzogbnVtYmVyLCBtYXRjaENvdW50OiBudW1iZXJ9PiB7XG4gIGNvbnN0IG1vbnRobHlEYXRhID0gbmV3IE1hcCgpXG4gIFxuICByYXRpbmdzLmZvckVhY2gocmF0aW5nID0+IHtcbiAgICBjb25zdCBkYXRlID0gbmV3IERhdGUocmF0aW5nLmNyZWF0ZWRBdClcbiAgICBjb25zdCBtb250aEtleSA9IGAke2RhdGUuZ2V0RnVsbFllYXIoKX0tJHsoZGF0ZS5nZXRNb250aCgpICsgMSkudG9TdHJpbmcoKS5wYWRTdGFydCgyLCAnMCcpfWBcbiAgICBcbiAgICBpZiAoIW1vbnRobHlEYXRhLmhhcyhtb250aEtleSkpIHtcbiAgICAgIG1vbnRobHlEYXRhLnNldChtb250aEtleSwge1xuICAgICAgICByYXRpbmdzOiBbXSxcbiAgICAgICAgbWF0Y2hlczogbmV3IFNldCgpXG4gICAgICB9KVxuICAgIH1cbiAgICBcbiAgICBtb250aGx5RGF0YS5nZXQobW9udGhLZXkpLnJhdGluZ3MucHVzaChyYXRpbmcucmF0aW5nKVxuICAgIG1vbnRobHlEYXRhLmdldChtb250aEtleSkubWF0Y2hlcy5hZGQocmF0aW5nLm1hdGNoLmlkKVxuICB9KVxuXG4gIHJldHVybiBBcnJheS5mcm9tKG1vbnRobHlEYXRhLmVudHJpZXMoKSlcbiAgICAubWFwKChbbW9udGgsIGRhdGFdKSA9PiAoe1xuICAgICAgbW9udGgsXG4gICAgICBhdmdSYXRpbmc6IE51bWJlcigoZGF0YS5yYXRpbmdzLnJlZHVjZSgoc3VtOiBudW1iZXIsIHI6IG51bWJlcikgPT4gc3VtICsgciwgMCkgLyBkYXRhLnJhdGluZ3MubGVuZ3RoKS50b0ZpeGVkKDIpKSxcbiAgICAgIG1hdGNoQ291bnQ6IGRhdGEubWF0Y2hlcy5zaXplXG4gICAgfSkpXG4gICAgLnNvcnQoKGEsIGIpID0+IGEubW9udGgubG9jYWxlQ29tcGFyZShiLm1vbnRoKSlcbiAgICAuc2xpY2UoLTEyKVxufVxuXG5mdW5jdGlvbiBjYWxjdWxhdGVTcG9ydEJyZWFrZG93bihwbGF5ZXJzOiBCYWxsb25PclBsYXllcltdKSB7XG4gIGNvbnN0IGJyZWFrZG93biA9IG5ldyBNYXAoKVxuICBcbiAgcGxheWVycy5mb3JFYWNoKHBsYXllciA9PiB7XG4gICAgaWYgKCFicmVha2Rvd24uaGFzKHBsYXllci5zcG9ydCkpIHtcbiAgICAgIGJyZWFrZG93bi5zZXQocGxheWVyLnNwb3J0LCB7XG4gICAgICAgIGNvdW50OiAwLFxuICAgICAgICB0b3RhbFJhdGluZ3M6IDBcbiAgICAgIH0pXG4gICAgfVxuICAgIFxuICAgIGNvbnN0IGRhdGEgPSBicmVha2Rvd24uZ2V0KHBsYXllci5zcG9ydClcbiAgICBkYXRhLmNvdW50KytcbiAgICBkYXRhLnRvdGFsUmF0aW5ncyArPSBwbGF5ZXIudG90YWxSYXRpbmdzXG4gIH0pXG5cbiAgcmV0dXJuIEFycmF5LmZyb20oYnJlYWtkb3duLmVudHJpZXMoKSkubWFwKChbc3BvcnQsIGRhdGFdKSA9PiAoe1xuICAgIHNwb3J0LFxuICAgIHBsYXllckNvdW50OiBkYXRhLmNvdW50LFxuICAgIGF2Z1JhdGluZzogcGxheWVyc1xuICAgICAgLmZpbHRlcihwID0+IHAuc3BvcnQgPT09IHNwb3J0KVxuICAgICAgLnJlZHVjZSgoc3VtLCBwKSA9PiBzdW0gKyBwLmF2Z1JhdGluZywgMCkgLyBkYXRhLmNvdW50LFxuICAgIHRvdGFsUmF0aW5nczogZGF0YS50b3RhbFJhdGluZ3NcbiAgfSkpXG59Il0sIm5hbWVzIjpbInByaXNtYSIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJzcG9ydCIsInBvc2l0aW9uIiwibWluTWF0Y2hlcyIsImxpbWl0IiwicGVyaW9kIiwiZXhjbHVkZUYxIiwicXVlcnkiLCJjb25zb2xlIiwibG9nIiwic3BvcnRGaWx0ZXIiLCJ0b1N0cmluZyIsInRvVXBwZXJDYXNlIiwibm90IiwicG9zaXRpb25GaWx0ZXIiLCJkYXRlRmlsdGVyIiwibm93IiwiRGF0ZSIsInllYXJBZ28iLCJzZXRGdWxsWWVhciIsImdldEZ1bGxZZWFyIiwiY3JlYXRlZEF0IiwiZ3RlIiwic2Vhc29uU3RhcnQiLCJzZXRNb250aCIsImdldE1vbnRoIiwic2l4TW9udGhzQWdvIiwicGxheWVyc1dpdGhSYXRpbmdzIiwicGxheWVyIiwiZmluZE1hbnkiLCJ3aGVyZSIsInJhdGluZ3MiLCJzb21lIiwiaW5jbHVkZSIsIm1hdGNoIiwic2VsZWN0IiwiaWQiLCJob21lVGVhbSIsImF3YXlUZWFtIiwiZGF0ZSIsImNvbXBldGl0aW9uIiwidXNlciIsIm5hbWUiLCJvcmRlckJ5IiwibGVuZ3RoIiwiZnVzZWRQbGF5ZXJzIiwiTWFwIiwibm9ybWFsaXplZE5hbWUiLCJub3JtYWxpemVQbGF5ZXJOYW1lIiwiaGFzIiwiZXhpc3RpbmdQbGF5ZXIiLCJnZXQiLCJwdXNoIiwidGVhbXMiLCJhZGQiLCJ0ZWFtIiwicG9zaXRpb25zIiwic2V0Iiwib3JpZ2luYWxJZCIsIlNldCIsInNpemUiLCJiYWxsb25PckNhbmRpZGF0ZXMiLCJmdXNlZFBsYXllciIsImVudHJpZXMiLCJwYXJzZUludCIsImF2Z1JhdGluZyIsInJlZHVjZSIsInN1bSIsInIiLCJyYXRpbmciLCJiZXN0UmF0aW5nIiwiYmVzdCIsImN1cnJlbnQiLCJ1bmlxdWVNYXRjaGVzIiwiZm9yRWFjaCIsIm1hdGNoSWQiLCJ0b3RhbE1hdGNoZXMiLCJyZWNlbnRNYXRjaGVzIiwiQXJyYXkiLCJmcm9tIiwidmFsdWVzIiwic29ydCIsImEiLCJiIiwiZ2V0VGltZSIsInNsaWNlIiwibWFwIiwibWF0Y2hEYXRhIiwibWF0Y2hBdmdSYXRpbmciLCJiZXN0Q29tbWVudCIsImZpbmQiLCJjb21tZW50IiwicGxheWVyVGVhbSIsImdldFBsYXllclRlYW1Gb3JNYXRjaCIsIk51bWJlciIsInRvRml4ZWQiLCJyYXRpbmdIaXN0b3J5IiwiY2FsY3VsYXRlTW9udGhseUhpc3RvcnkiLCJ0ZWFtQnJlYWtkb3duIiwiY2FsY3VsYXRlVGVhbUJyZWFrZG93biIsImJlc3RNYXRjaFRlYW0iLCJ0b3RhbFJhdGluZ3MiLCJiZXN0TWF0Y2giLCJNYXRoIiwiYWJzIiwidG9wUGxheWVycyIsImdsb2JhbFN0YXRzIiwidG90YWxQbGF5ZXJzIiwicCIsImF2Z1JhdGluZ0dsb2JhbCIsInRvcFJhdGluZyIsInNwb3J0QnJlYWtkb3duIiwiY2FsY3VsYXRlU3BvcnRCcmVha2Rvd24iLCJmdXNpb25TdGF0cyIsIm9yaWdpbmFsUGxheWVycyIsImZ1c2lvblJlZHVjdGlvbiIsImpvaW4iLCJzdWNjZXNzIiwiYmFsbG9uT3IiLCJzdGF0cyIsImZpbHRlcnMiLCJkZXRhaWxzIiwiRXJyb3IiLCJtZXNzYWdlIiwibm9ybWFsaXplZCIsInRvTG93ZXJDYXNlIiwidHJpbSIsIm5vcm1hbGl6ZSIsInJlcGxhY2UiLCJpbml0aWFsTWFwcGluZ3MiLCJwbGF5ZXJUZWFtcyIsInRlYW1Mb3dlciIsImluY2x1ZGVzIiwic3BsaXQiLCJ0ZWFtU3RhdHMiLCJtYXRjaGVzIiwibm9ybWFsaXplZFRlYW0iLCJ0IiwiZmlsdGVyIiwibWF0Y2hDb3VudCIsInJhdGluZ0NvdW50IiwibW9udGhseURhdGEiLCJtb250aEtleSIsInBhZFN0YXJ0IiwibW9udGgiLCJkYXRhIiwibG9jYWxlQ29tcGFyZSIsInBsYXllcnMiLCJicmVha2Rvd24iLCJjb3VudCIsInBsYXllckNvdW50Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./pages/api/ballon-or.ts\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fballon-or&preferredRegion=&absolutePagePath=.%2Fpages%2Fapi%2Fballon-or.ts&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();